<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="kindquiet"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="kindquiet素食勤俭敬老孝慈" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><title>计算机 - kindquiet素食勤俭敬老孝慈</title><script>var _hmt = _hmt || [];(function() {  var hm = document.createElement("script");  hm.src = "//hm.baidu.com/hm.js?33ec0e4a308e2f174e68f15c700d8b5d";  var s = document.getElementsByTagName("script")[0];   s.parentNode.insertBefore(hm, s);})();</script><link rel="stylesheet" href="/css/style.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="site-head"><div class="inner"><h1 class="site-title u-fl"><a href="/">kindquiet素食勤俭敬老孝慈</a></h1><nav class="site-nav u-fr"><ul class="site-nav__list"><li class="site-nav__item"><a href="/" class="site-nav__link">Home</a></li><li class="site-nav__item"><a href="/archives" class="site-nav__link">Archives</a></li></ul></nav></div></header><section class="site-content"><main class="site-main"><article class="post"><header class="post__head"><time datetime="2010-04-27T02:49:58.000Z" class="post__time">四月 27, 2010</time><h1 class="post__title"><a href="/2010/04/27/w/wordpress-e5-b8-b8-e7-94-a8-e7-bb-b4-e6-8a-a4-e6-98-8e-e4-bb-a4/">wordpress常用维护明令</a></h1></header><div class="post__main"><p>备份数据库(innodb)</p>
<pre><code>/usr/local/mysql/bin/mysqldump -uuser -ppass --single-transaction --<span class="keyword">default</span>-character-<span class="keyword">set</span>=utf8 --opt --extended-insert=<span class="keyword">false</span> --triggers --routines --hex-blob wpdatabase  wpdatabase.`date +%F`.sql

清理Revisions(历史版本)

use wpdatabase;

<span class="keyword">select</span> count(<span class="number">1</span>) <span class="keyword">from</span> wp_posts <span class="keyword">where</span> post_type=&amp;<span class="string">#39</span>;revision&amp;<span class="string">#39</span>;;

delete <span class="keyword">from</span> wp_posts <span class="keyword">where</span> post_type=&amp;<span class="string">#39</span>;revision&amp;<span class="string">#39</span>;;
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/04/27/w/wordpress-e5-b8-b8-e7-94-a8-e7-bb-b4-e6-8a-a4-e6-98-8e-e4-bb-a4/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-04-16T05:49:21.000Z" class="post__time">四月 16, 2010</time><h1 class="post__title"><a href="/2010/04/16/w/linux-e6-97-b6-e5-8c-ba-e5-92-8c-e6-97-b6-e9-97-b4/">Linux时区和时间</a></h1></header><div class="post__main"><p>如果服务器时区设置错误，比如不是CST而是EDT，用户可能会抱怨白天发布的文章，显示却是半夜。</p>
<pre><code>查看当前时区

date -R

查看硬件bios时间

hwclock -r

Linux的系统时区是通过符号连接<span class="regexp">/etc/</span>localtime来得到的。可以通过tzselect命令来设置时区。如果没有该命令，

复制相应的时区文件，替换系统时区文件；或者创建链接文件

cp <span class="regexp">/usr/</span>share<span class="regexp">/zoneinfo/</span>$主时区<span class="regexp">/$次时区 /</span>etc/localtime

在中国可以使用：

cp <span class="regexp">/usr/</span>share<span class="regexp">/zoneinfo/</span>Asia<span class="regexp">/Shanghai /</span>etc/localtime

也可以通过命令

ln s <span class="regexp">/usr/</span>share<span class="regexp">/zoneinfo/</span>Asia<span class="regexp">/Shanghai /</span>etc/localtime

来将时区设置为亚洲的上海。

配置文件<span class="regexp">/etc/</span>sysconfig<span class="regexp">/clock可用来设置用户选择何种方式显示时间。如果硬件时钟为本地时间，则UTC设为0，并且不用设置环境变量TZ。如果硬件时钟为UTC时间，则要设置UTC为1，并设置环境变量TZ（或配置文件/</span>etc<span class="regexp">/TZ）为时区信息，如Asia/</span>Shanghai。

cat <span class="regexp">/etc/</span>sysconfig/clock 

# The ZONE parameter is only evaluated by system-config-date.

# The timezone of the system is defined by the contents of <span class="regexp">/etc/</span>localtime.

ZONE=Asia/Shanghai

UTC=<span class="literal">false</span>

ARC=<span class="literal">false</span>

将当前时间和日期写入BIOS，避免重启后失效

hwclock -w
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/04/16/w/linux-e6-97-b6-e5-8c-ba-e5-92-8c-e6-97-b6-e9-97-b4/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-03-31T09:23:38.000Z" class="post__time">三月 31, 2010</time><h1 class="post__title"><a href="/2010/03/31/w/myisaminnodb-e9-82-a3-e4-b8-aa-e6-9b-b4-e5-bf-ab-e4-b8-80-e4-ba-9b/">myisam,innodb那个更快一些</a></h1></header><div class="post__main"><p>mysqlslap -hlocalhost -uroot —engine=innodb —auto-generate-sql-write-number=100000 —auto-generate-sql-guid-primary —concurrency=5,50,500 —number-of-queries=500000 —iterations=2 —number-char-cols=10 —number-int-cols=10 —auto-generate-sql —create-schema=sbtest —auto-generate-sql-load-type=mixed</p>
<pre><code>Benchmark

 Running <span class="keyword">for</span> engine innodb

 Average <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">96.510</span> <span class="built_in">seconds</span>

 Minimum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">95.215</span> <span class="built_in">seconds</span>

 Maximum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">97.805</span> <span class="built_in">seconds</span>

 Number <span class="operator">of</span> clients running queries: <span class="number">5</span>

 Average <span class="built_in">number</span> <span class="operator">of</span> queries per client: <span class="number">100000</span>

Benchmark

 Running <span class="keyword">for</span> engine innodb

 Average <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">97.762</span> <span class="built_in">seconds</span>

 Minimum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">96.139</span> <span class="built_in">seconds</span>

 Maximum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">99.386</span> <span class="built_in">seconds</span>

 Number <span class="operator">of</span> clients running queries: <span class="number">50</span>

 Average <span class="built_in">number</span> <span class="operator">of</span> queries per client: <span class="number">10000</span>

Benchmark

 Running <span class="keyword">for</span> engine innodb

 Average <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">142.323</span> <span class="built_in">seconds</span>

 Minimum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">140.955</span> <span class="built_in">seconds</span>

 Maximum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">143.691</span> <span class="built_in">seconds</span>

 Number <span class="operator">of</span> clients running queries: <span class="number">500</span>

 Average <span class="built_in">number</span> <span class="operator">of</span> queries per client: <span class="number">1000</span>

<span class="comment">------------------------------------- </span>

mysqlslap -hlocalhost -uroot <span class="comment">--engine=myisam --auto-generate-sql-write-number=100000 --auto-generate-sql-guid-primary --concurrency=5,50,500 --number-of-queries=500000 --iterations=2 --number-char-cols=10 --number-int-cols=10 --auto-generate-sql --create-schema=sbtest --auto-generate-sql-load-type=mixed</span>

Benchmark

 Running <span class="keyword">for</span> engine myisam

 Average <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">117.924</span> <span class="built_in">seconds</span>

 Minimum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">114.445</span> <span class="built_in">seconds</span>

 Maximum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">121.404</span> <span class="built_in">seconds</span>

 Number <span class="operator">of</span> clients running queries: <span class="number">5</span>

 Average <span class="built_in">number</span> <span class="operator">of</span> queries per client: <span class="number">100000</span>

Benchmark

 Running <span class="keyword">for</span> engine myisam

 Average <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">162.244</span> <span class="built_in">seconds</span>

 Minimum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">161.278</span> <span class="built_in">seconds</span>

 Maximum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">163.211</span> <span class="built_in">seconds</span>

 Number <span class="operator">of</span> clients running queries: <span class="number">50</span>

 Average <span class="built_in">number</span> <span class="operator">of</span> queries per client: <span class="number">10000</span>

Benchmark

 Running <span class="keyword">for</span> engine myisam

 Average <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">209.235</span> <span class="built_in">seconds</span>

 Minimum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">202.708</span> <span class="built_in">seconds</span>

 Maximum <span class="built_in">number</span> <span class="operator">of</span> <span class="built_in">seconds</span> <span class="built_in">to</span> run all queries: <span class="number">215.762</span> <span class="built_in">seconds</span>

 Number <span class="operator">of</span> clients running queries: <span class="number">500</span>

 Average <span class="built_in">number</span> <span class="operator">of</span> queries per client: <span class="number">1000</span>
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/03/31/w/myisaminnodb-e9-82-a3-e4-b8-aa-e6-9b-b4-e5-bf-ab-e4-b8-80-e4-ba-9b/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-03-19T06:01:58.000Z" class="post__time">三月 19, 2010</time><h1 class="post__title"><a href="/2010/03/19/w/apache-e6-97-a0-e6-b3-95-e5-90-af-e5-8a-a8-e6-b2-a1-e6-9c-89-e9-94-99-e8-af-af-e6-8f-90-e7-a4-ba-e7-9a-84-e5-8f-af-e8-83-bd-e5-8e-9f-e5-9b-a0/">apache无法启动没有错误提示的可能原因</a></h1></header><div class="post__main"><p>环境:CentOS 5,Apache/2.2</p>
<pre><code>apache运行正常，重启后不能启动，没有任何错误提示。

排错过程：

检查硬盘分区，空闲容量还很多；

检查错误日志，没有新的内容；

怀疑有人修改配置文件，注释部分内容；

最终找到了原因，原来是apache的error_<span class="built_in">log</span>达到了<span class="number">2147483647</span> byte，清空error_<span class="built_in">log</span>，正常启动。

同样，access_<span class="built_in">log</span>文件超过<span class="number">2</span>G也会导致不能启动。

当时没有注意<span class="number">2147483647</span>这个数字就是<span class="number">2</span>G-<span class="number">1</span>，其实，从启动是日志中没有任何内容也可以推理问题和日志文件有关。
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/03/19/w/apache-e6-97-a0-e6-b3-95-e5-90-af-e5-8a-a8-e6-b2-a1-e6-9c-89-e9-94-99-e8-af-af-e6-8f-90-e7-a4-ba-e7-9a-84-e5-8f-af-e8-83-bd-e5-8e-9f-e5-9b-a0/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-03-04T06:32:39.000Z" class="post__time">三月 4, 2010</time><h1 class="post__title"><a href="/2010/03/04/w/linux-e7-9a-84-e4-b8-ad-e6-96-87-e5-a4-84-e7-90-86-e5-92-8c-e6-96-87-e4-bb-b6-e5-90-8d-e4-b9-b1-e7-a0-81-e8-bd-ac-e6-8d-a2/">linux的中文处理和文件名乱码转换</a></h1></header><div class="post__main"><p>1、locale</p>
<p>/etc/sysconfig/i18n </p>
<pre><code>#LANG=zh_CN<span class="class">.GB18030</span>

#LC_ALL=zh_CN<span class="class">.GB18030</span>

LANG=zh_CN<span class="class">.UTF-8</span>

LC_ALL=zh_CN<span class="class">.UTF-8</span>

LANGUAGE=en_US<span class="class">.UTF-8</span>:zh_CN<span class="class">.GB18030</span>:zh_CN<span class="class">.GB2312</span>:zh_CN:en_US<span class="class">.UTF-8</span>

SYSFONT=latarcyrheb-sun16
</code></pre><p>2、samba</p>
<p>/etc/samba/smb.conf</p>
<p>[global]</p>
<pre><code>DISPLAY <span class="variable">CHARSET=</span> utf8

UNIX <span class="variable">CHARSET =</span> utf8

<span class="comment">#UNIX CHARSET = cp936</span>

DOS <span class="variable">CHARSET =</span> utf8
</code></pre><h1 id="关键是UNIX_CHARSET_=_utf8，其它可以不加">关键是UNIX CHARSET = utf8，其它可以不加</h1><p>3、文件名乱码转换</p>
<p>yum install convmv</p>
<p>convmv -f GBK -t UTF-8 *.zip —notest</p>
<p>—notest不加测试，直接转换，建议先测试。</p>
</div><footer class="post__foot u-cf"><a href="/2010/03/04/w/linux-e7-9a-84-e4-b8-ad-e6-96-87-e5-a4-84-e7-90-86-e5-92-8c-e6-96-87-e4-bb-b6-e5-90-8d-e4-b9-b1-e7-a0-81-e8-bd-ac-e6-8d-a2/#comments" class="post__foot-link u-fr">评论</a></footer></article></main><aside class="site-aside"><div class="widget about"><div class="b"><div class="info u-cf"><img src="/avatar.jpg"><div class="text"> <p>dayu graceful</p><p>vegan</p><p>linux sysadm</p><p> <a href="http://www.weibo.com/vegetablegrain" title="wiebo" class="weibo ico"></a><a href="http://user.qzone.qq.com/13467/main" title="qq" class="qq ico"></a></p></div></div></div></div><div class="widget tags"><div class="h">categories</div><div class="b"> <ul><li><a href="/categories/计算机/">计算机</a><small>(137)</small></li><li><a href="/categories/佛法传统文化/">佛法传统文化</a><small>(18)</small></li><li><a href="/categories/健康/">健康</a><small>(12)</small></li><li><a href="/categories/学习/">学习</a><small>(2)</small></li><li><a href="/categories/default/">default</a><small>(1)</small></li><li><a href="/categories/健康之道/">健康之道</a><small>(1)</small></li><li><a href="/categories/网络/">网络</a><small>(1)</small></li><li><a href="/categories/recreation/">recreation</a><small>(1)</small></li></ul></div></div><div class="widget links"><div class="h">links</div><div class="b"> <ul><li><a href="http://www.enzymesos.com/">酵素Enzyme救地球</a></li><li><a href="http://www.osalt.com/">商业软件的开源替代品</a></li></ul></div></div></aside></section><footer class="site-foot"><div class="inner"><div class="site-copy u-fl">© 2015 dayu<bdi> ❤ Theme by <a href="http://riny.net" target="_blank">Bubblings</a></bdi></div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/categories/计算机/page/19/" class="page-menu__link icon-arrow-left">prev</a></li><li class="page-menu__item"><a title="Next" href="/categories/计算机/page/21/" class="page-menu__link icon-arrow-right">next</a></li></menu></div></footer><div id="back-top" title="返回顶部"></div><script src="/js/script.js"></script></body></html>