<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="kindquiet"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="kindquiet素食勤俭敬老孝慈" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><title>kindquiet素食勤俭敬老孝慈</title><meta name="keywords" content="centos,素食"><meta name="description" content="kindquiet素食勤俭敬老孝慈"><script>var _hmt = _hmt || [];(function() {  var hm = document.createElement("script");  hm.src = "//hm.baidu.com/hm.js?33ec0e4a308e2f174e68f15c700d8b5d";  var s = document.getElementsByTagName("script")[0];   s.parentNode.insertBefore(hm, s);})();</script><link rel="stylesheet" href="/css/style.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="site-head"><div class="inner"><h1 class="site-title u-fl"><a href="/">kindquiet素食勤俭敬老孝慈</a></h1><nav class="site-nav u-fr"><ul class="site-nav__list"><li class="site-nav__item"><a href="/" class="site-nav__link">Home</a></li><li class="site-nav__item"><a href="/archives" class="site-nav__link">Archives</a></li></ul></nav></div></header><section class="site-content"><main class="site-main"><article class="post"><header class="post__head"><time datetime="2009-07-10T07:35:33.000Z" class="post__time">七月 10, 2009</time><h1 class="post__title"><a href="/2009/07/10/w/firefox-e5-bf-85-e5-a4-87-e7-9a-84-e4-bc-98-e7-a7-80-e6-8f-92-e4-bb-b6/">firefox必备的优秀插件</a></h1></header><div class="post__main"><p>屏蔽自动播放。 不被网站的自动播放音乐骚扰了。如果想要播放，用鼠标点一下就可以了。</p>
<p>firefox6请使用<span style="font-weight: bold;">Flashblock ,</span>安装地址</p>
<p><a href="https://addons.mozilla.org/zh-CN/firefox/addon/flashblock/" target="_blank" rel="external">https://addons.mozilla.org/zh-CN/firefox/addon/flashblock/</a></p>
<p>说明：Never be annoyed by a Flash animation again! Blocks Flash so it won&#39;t get in your way, but if you want to see it, just click on…</p>
<pre><code>Stop Autoplay ，适用于Firefox: <span class="number">3.0</span> &amp;ndash; <span class="number">3.5</span>.* 

安装地址

https:<span class="comment">//addons.mozilla.org/en-US/firefox/addon/1765</span>

Long Description:

Disable the autoplay <span class="keyword">of</span> the embedded music <span class="keyword">and</span> movie. The users have <span class="number">2</span> modes <span class="keyword">to</span> choose:rnrn1) Disable only the autostart <span class="keyword">of</span> the embedded media. The users can press the play button <span class="keyword">of</span> the controller <span class="keyword">to</span> play it.rnrn2) <span class="keyword">Block</span> the media when loading a page. It will be replaced <span class="keyword">by</span> a red frame. Press the red frame <span class="keyword">to</span> load <span class="keyword">and</span> <span class="keyword">then</span> play it.rnrnThis <span class="keyword">extension</span> can also convert the ie-only tag &amp;quot;bgsound&amp;quot; <span class="keyword">to</span> &amp;quot;embed&amp;quot;, <span class="keyword">and</span> it can also <span class="keyword">block</span> Flash media <span class="keyword">by</span> a costumizable blacklist.

&amp;nbsp;
</code></pre></div><footer class="post__foot u-cf"><a href="/2009/07/10/w/firefox-e5-bf-85-e5-a4-87-e7-9a-84-e4-bc-98-e7-a7-80-e6-8f-92-e4-bb-b6/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-07-10T07:14:08.000Z" class="post__time">七月 10, 2009</time><h1 class="post__title"><a href="/2009/07/10/w/e7-a6-81-e6-ad-a2wordpress-e8-87-aa-e5-8a-a8-e6-9b-bf-e6-8d-a2-e5-8d-8a-e8-a7-92-e6-a0-87-e7-82-b9-e7-ac-a6-e5-8f-b7/">禁止WordPress自动替换半角标点符号</a></h1></header><div class="post__main"><p>WordPress会将半角标点符号自动转换成全角的，但并没有替换数据库里的信息，这样会导致一些技术文章的代码粘贴后出错，防盗版？解决方法:</p>
<p>1、 编辑 wp-includes/formatting.php 文件，找到以下代码：</p>
<p>&nbsp;&nbsp;&nbsp; // static strings</p>
<p>&nbsp;&nbsp;&nbsp; $curl = str_replace($static_characters, $static_replacements, $curl);</p>
<p>&nbsp;&nbsp;&nbsp; // regular expressions</p>
<p>&nbsp;&nbsp;&nbsp; $curl = preg_replace($dynamic_characters, $dynamic_replacements, $curl);</p>
<p>正是 str_replace() 和 preg_replace() 两个函数在作怪。</p>
<p>2、 将相应语句注释，禁用自动替换功能：</p>
<p>&nbsp;&nbsp;&nbsp; // static strings</p>
<p>&nbsp;&nbsp;&nbsp; //$curl = str_replace($static_characters, $static_replacements, $curl);</p>
<p>&nbsp;&nbsp;&nbsp; // regular expressions</p>
<p>&nbsp;&nbsp;&nbsp; //$curl = preg_replace($dynamic_characters, $dynamic_replacements, $curl);</p>
<p>OK，以后Wordpress在也不会自作聪明的将半角标点符号转换成全角标点符号了。</p>
<p>来源:</p>
<p><a href="http://buyu.name/074.html" target="_blank" rel="external">http://buyu.name/074.html</a></p>
</div><footer class="post__foot u-cf"><a href="/2009/07/10/w/e7-a6-81-e6-ad-a2wordpress-e8-87-aa-e5-8a-a8-e6-9b-bf-e6-8d-a2-e5-8d-8a-e8-a7-92-e6-a0-87-e7-82-b9-e7-ac-a6-e5-8f-b7/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-06-30T08:39:01.000Z" class="post__time">六月 30, 2009</time><h1 class="post__title"><a href="/2009/06/30/w/mysql-e4-b8-bb-e4-bb-8e-e5-a4-8d-e5-88-b6-e4-b8-8d-e6-88-90-e5-8a-9f-e7-9a-84-e5-8f-af-e8-83-bd-e5-8e-9f-e5-9b-a0/">mysql 主从复制不成功的可能原因</a></h1></header><div class="post__main"><p>环境:centos 5</p>
<p>mysql 5主从复制报错:</p>
<p>[ERROR] Slave SQL: Error ‘Duplicate entry ‘…’ for key ‘PRIMARY’’ on query. Default database: ‘blog’. Query: ‘insert into tb_article_peak(…)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; values(…’)’, Error_code: 1062</p>
<p>stop slave;</p>
<p>desc tb_article_peak;</p>
<p>select * from tb_article_peak where peak_id&gt;=’…’;</p>
<p>delete tb_article_peak where peak_id&gt;=’…’;</p>
<p>start slave;</p>
<p>复制恢复正常。</p>
<p>过一段时间又报错，间隔从几小时到几天不等。</p>
<p>不解。</p>
<p>只好把读写都集中到master db上。</p>
<p>但不应是mysql replication 的问题，因为新的数据产生量很大，如果复制有问题，不会间隔几天才报错。</p>
<p>最后终于找到原因:</p>
<p>某一段代码把连接池弄反，写时调用了读的连接，写到了slave db上。所以产生Duplicate entry。</p>
</div><footer class="post__foot u-cf"><a href="/2009/06/30/w/mysql-e4-b8-bb-e4-bb-8e-e5-a4-8d-e5-88-b6-e4-b8-8d-e6-88-90-e5-8a-9f-e7-9a-84-e5-8f-af-e8-83-bd-e5-8e-9f-e5-9b-a0/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-06-25T00:34:06.000Z" class="post__time">六月 25, 2009</time><h1 class="post__title"><a href="/2009/06/25/w/squid-e4-bc-98-e5-8c-96/">squid优化</a></h1></header><div class="post__main"><p>/usr/local/squid/bin/squidclient -p 3128 -h localhost mgr:io</p>
<pre><code><span class="status">HTTP/1.0 <span class="number">200</span> OK</span>

<span class="http"><span class="attribute">Server</span>: <span class="string">squid/3.0.STABLE15</span>

<span class="elixir"><span class="constant">HTTP I/O</span>

number of <span class="symbol">reads:</span> <span class="number">18985956</span>

<span class="constant">Read Histogram:</span>

&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">1</span>-&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">1</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">766</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">2</span>-&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">2</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">38574</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">3</span>-&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">4</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">9769</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">5</span>-&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">8</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">30168</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">9</span>-&amp;nbsp;&amp;nbsp; <span class="number">16</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">10200</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp; <span class="number">17</span>-&amp;nbsp;&amp;nbsp; <span class="number">32</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">31835</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp; <span class="number">33</span>-&amp;nbsp;&amp;nbsp; <span class="number">64</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">32801</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;&amp;nbsp; <span class="number">65</span>-&amp;nbsp; <span class="number">128</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp; <span class="number">113799</span>&amp;nbsp; <span class="number">1</span>%

&amp;nbsp; <span class="number">129</span>-&amp;nbsp; <span class="number">256</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp; <span class="number">457726</span>&amp;nbsp; <span class="number">2</span>%

&amp;nbsp; <span class="number">257</span>-&amp;nbsp; <span class="number">512</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp; <span class="number">1161065</span>&amp;nbsp; <span class="number">6</span>%

&amp;nbsp; <span class="number">513</span>- <span class="number">1024</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp; <span class="number">2114155</span> <span class="number">11</span>%

&amp;nbsp;<span class="number">1025</span>- <span class="number">2048</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp; <span class="number">4009525</span> <span class="number">21</span>%

&amp;nbsp;<span class="number">2049</span>- <span class="number">4096</span><span class="symbol">:&amp;nbsp</span>; <span class="number">10975545</span> <span class="number">58</span>%

&amp;nbsp;<span class="number">4097</span>- <span class="number">8192</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">26</span>&amp;nbsp; <span class="number">0</span>%

&amp;nbsp;<span class="number">8193</span>-<span class="number">16384</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">2</span>&amp;nbsp; <span class="number">0</span>%

<span class="number">16385</span>-<span class="number">32768</span><span class="symbol">:&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span>&amp;nbsp; <span class="number">0</span>%

vim squid.conf

minimum_object_size <span class="number">64</span> <span class="constant">KB</span>

maximum_object_size <span class="number">8192</span> <span class="constant">KB</span>

maximum_object_size_in_memory <span class="number">4096</span> <span class="constant">KB</span></span></span>
</code></pre><p>&nbsp;</p>
<p>/usr/local/squid/sbin/squid -k reconfigure</p>
</div><footer class="post__foot u-cf"><a href="/2009/06/25/w/squid-e4-bc-98-e5-8c-96/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-06-16T06:02:57.000Z" class="post__time">六月 16, 2009</time><h1 class="post__title"><a href="/2009/06/16/w/squid-iptables-e9-80-8f-e6-98-8e-e4-bb-a3-e7-90-86-qq-e3-80-81msn-e4-b8-8d-e8-83-bd-e7-99-bb-e5-bd-95-e8-a7-a3-e5-86-b3-e5-8a-9e-e6-b3-95/">squid iptables 透明代理 QQ、msn不能登录解决办法</a></h1></header><div class="post__main"><p>linux服务器:centos</p>
<p>&nbsp;</p>
<p>squid3</p>
<p>squid日志:</p>
<p>&nbsp;&quot;NONE error:unsupported-request-method HTTP/0.0&quot; 400 1817 NONE:NONE，</p>
<p>原来qq使用了80端口但使用的非http标准协议。</p>
<p>公司允许使用qq、msn，</p>
<p>只好打开udp 8000端口:</p>
<p>-A FORWARD -m state —state NEW -m udp -p udp -s 192.168.6.0/23 -d 58.251.0.0/16 —dport 8000 -j ACCEPT</p>
<p>squid透明代理https以后，msn(live messager)不能登录，报错:</p>
<p>MSN登录报错80048820 </p>
<p>只好取消REDIRECT，打开443端口:</p>
<p>&nbsp;-A FORWARD -m state —state NEW -m tcp -p tcp -s 192.168.6.0/23 —dport 443 —tcp-flags SYN,RST,ACK SYN -j ACCEPT</p>
<p>附:squid日志状态说明</p>
<p>TCP_HIT</p>
<p>A valid copy of the requested object was in the cache.</p>
<p>TCP_MISS</p>
<p>The requested object was not in the cache.</p>
<p>TCP_REFRESH_HIT</p>
<p>The requested object was cached but STALE. The IMS query for the object resulted in &ldquo;304 not modified&rdquo;.</p>
<p>TCP_REF_FAIL_HIT</p>
<p>The requested object was cached but STALE. The IMS query failed and the stale object was delivered.</p>
<p>TCP_REFRESH_MISS</p>
<p>The requested object was cached but STALE. The IMS query returned the new content.</p>
<p>TCP_CLIENT_REFRESH_MISS</p>
<p>The client issued a &ldquo;no-cache&rdquo; pragma, or some analogous cache control command along with the request. Thus, the cache</p>
<p>has to refetch the object.</p>
<p>TCP_IMS_HIT</p>
<p>The client issued an IMS request for an object which was in the cache and fresh.</p>
<p>TCP_SWAPFAIL_MISS</p>
<p>The object was believed to be in the cache, but could not be accessed.</p>
<p>TCP_NEGATIVE_HIT</p>
<p>Request for a negatively cached object, e.g. &ldquo;404 not found&rdquo;, for which the cache believes to know that it is</p>
<p>inaccessible. Also refer to the explainations for negative_ttl in your squid.conf file.</p>
<p>TCP_MEM_HIT</p>
<p>A valid copy of the requested object was in the cache and it was in memory, thus avoiding disk accesses.</p>
<p>TCP_DENIED</p>
<p>Access was denied for this request.</p>
<p>TCP_OFFLINE_HIT</p>
<p>The requested object was retrieved from the cache during offline mode. The offline mode never validates any object, see</p>
<p>offline_mode in squid.conf file.</p>
<p>UDP_HIT</p>
<p>A valid copy of the requested object was in the cache.</p>
<p>UDP_MISS</p>
<p>The requested object is not in this cache.</p>
<p>UDP_DENIED</p>
<p>Access was denied for this request.</p>
<p>UDP_INVALID</p>
<p>An invalid request was received.</p>
<p>UDP_MISS_NOFETCH</p>
<p>During &ldquo;-Y&rdquo; startup, or during frequent failures, a cache in hit only mode will return either UDP_HIT or this code.</p>
<p>Neighbours will thus only fetch hits.</p>
<p>NONE</p>
<p>Seen with errors and cachemgr requests.</p>
<p>The following codes are no longer available in Squid-2:</p>
<p>ERR_*</p>
<p>Errors are now contained in the status code.</p>
<p>TCP_CLIENT_REFRESH</p>
<p>See: TCP_CLIENT_REFRESH_MISS.</p>
<p>TCP_SWAPFAIL</p>
<p>See: TCP_SWAPFAIL_MISS.</p>
<p>TCP_IMS_MISS</p>
<p>Deleted, TCP_IMS_HIT used instead.</p>
<p>UDP_HIT_OBJ</p>
<p>Hit objects are no longer available.</p>
<p>UDP_RELOADING</p>
<p>See: UDP_MISS_NOFETCH.</p>
<p>后面找到了中文版，补充全一些：</p>
<p>access.log结果编码</p>
<p>相应于HTTP请求，下列标签可能出现在access.log文件的第四个域。</p>
<p>TCP_HIT</p>
<p>Squid发现请求资源的貌似新鲜的拷贝，并将其立即发送到客户端。</p>
<p>TCP_MISS</p>
<p>Squid没有请求资源的cache拷贝。</p>
<p>TCP_REFRESH_HIT</p>
<p>Squid发现请求资源的貌似陈旧的拷贝，并发送确认请求到原始服务器。原始服务器返回304（未修改）响应，指示squid的拷贝仍旧是新鲜的。</p>
<p>TCP_REF_FAIL_HIT</p>
<p>Squid发现请求资源的貌似陈旧的拷贝，并发送确认请求到原始服务器。然而，原始服务器响应失败，或者返回的响应Squid不能理解。在此情形下，squid发送现有cache拷贝（很可能是陈旧的）到客户端。</p>
<p>TCP_REFRESH_MISS</p>
<p>Squid发现请求资源的貌似陈旧的拷贝，并发送确认请求到原始服务器。原始服务器响应新的内容，指示这个cache拷贝确实是陈旧的。</p>
<p>TCP_CLIENT_REFRESH_MISS</p>
<p>Squid发现了请求资源的拷贝，但客户端的请求包含了Cache-Control: no-cache指令。Squid转发客户端的请求到原始服务器，强迫cache确认。</p>
<p>TCP_IMS_HIT</p>
<p>客户端发送确认请求，Squid发现更近来的、貌似新鲜的请求资源的拷贝。Squid发送更新的内容到客户端，而不联系原始服务器。</p>
<p>TCP_SWAPFAIL_MISS</p>
<p>Squid发现请求资源的有效拷贝，但从磁盘装载它失败。这时squid发送请求到原始服务器，就如同这是个cache丢失一样。</p>
<p>TCP_NEGATIVE_HIT</p>
<p>在对原始服务器的请求导致HTTP错误时，Squid也会cache这个响应。在短时间内对这些资源的重复请求，导致了否命中。 negative_ttl指令控制这些错误被cache的时间数量。请注意这些错误只在内存cache，不会写往磁盘。下列HTTP状态码可能导致否定 cache（也遵循于其他约束）： 204, 305, 400, 403, 404, 405, 414, 500, 501, 502, 503, 504。</p>
<p>TCP_MEM_HIT</p>
<p>Squid在内存cache里发现请求资源的有效拷贝，并将其立即发送到客户端。注意这点并非精确的呈现了所有从内存服务的响应。例如，某些cache在内存里，但要求确认的响应，会以TCP_REFRESH_HIT, TCP_REFRESH_MISS等形式记录。</p>
<p>TCP_DENIED</p>
<p>因为http_access或http_reply_access规则，客户端的请求被拒绝了。注意被http_access拒绝的请求在第9域的值是NONE/-，然而被http_reply_access拒绝的请求，在相应地方有一个有效值。</p>
<p>TCP_OFFLINE_HIT</p>
<p>当offline_mode激活时，Squid对任何cache响应返回cache命中，而不用考虑它的新鲜程度。</p>
<p>TCP_REDIRECT</p>
<p>重定向程序告诉Squid产生一个HTTP重定向到新的URI（见11.1节）。正常的，Squid不会记录这些重定向。假如要这样做，必须在编译squid前，手工定义LOG_TCP_REDIRECTS预处理指令。</p>
<p>NONE</p>
<p>无分类的结果用于特定错误，例如无效主机名。</p>
<p>相应于ICP查询，下列标签可能出现在access.log文件的第四域。</p>
<p>UDP_HIT</p>
<p>Squid在cache里发现请求资源的貌似新鲜的拷贝。</p>
<p>UDP_MISS</p>
<p>Squid没有在cache里发现请求资源的貌似新鲜的拷贝。假如同一目标通过HTTP请求，就可能是个cache丢失。请对比UDP_MISS_NOFETCH。</p>
<p>UDP_MISS_NOFETCH</p>
<p>跟UDP_MISS类似，不同的是这里也指示了Squid不愿去处理相应的HTTP请求。假如使用了-Y命令行选项，Squid在启动并编译其内存索引时，会返回这个标签而不是UDP_MISS。</p>
<p>UDP_DENIED</p>
<p>因为icp_access规则，ICP查询被拒绝。假如超过95%的到某客户端的ICP响应是UDP_DENIED，并且客户端数据库激活了（见附录A），Squid在1小时内，停止发送任何ICP响应到该客户端。若这点发生，你也可在cache.log里见到一个警告。</p>
<p>UDP_INVALID</p>
<p>Squid接受到无效查询（例如截断的消息、无效协议版本、URI里的空格等）。Squid发送UDP_INVALID响应到客户端。</p>
<p>附:HTTP响应状态码</p>
<p>Table 13-1列出了数字HTTP响应CODE和理由短句。注意Squid和其他HTTP客户端仅仅关注这些数字值。理由短句是纯解释性的，不会影响响应的意义。对每个状态码，也提供了一个到RFC 2616的具体节的索引。注意状态码0和600是squid使用的非标准的值，不会在RFC里提到。</p>
<p>Table 13-1. HTTP response status codes</p>
<p>Code &nbsp;&nbsp;&nbsp; Reason phrase &nbsp;&nbsp;&nbsp; RFC 2616 section</p>
<p>0 &nbsp;&nbsp;&nbsp; No Response Received (Squid-specific) &nbsp;&nbsp;&nbsp; N/A</p>
<p>1xx &nbsp;&nbsp;&nbsp; Informational &nbsp;&nbsp;&nbsp; 10.1</p>
<p>100 &nbsp;&nbsp;&nbsp; Continue &nbsp;&nbsp;&nbsp; 10.1.1</p>
<p>101 &nbsp;&nbsp;&nbsp; Switching Protocols &nbsp;&nbsp;&nbsp; 10.1.2</p>
<p>2xx &nbsp;&nbsp;&nbsp; Successful &nbsp;&nbsp;&nbsp; 10.2</p>
<p>200 &nbsp;&nbsp;&nbsp; OK &nbsp;&nbsp;&nbsp; 10.2.1</p>
<p>201 &nbsp;&nbsp;&nbsp; Created &nbsp;&nbsp;&nbsp; 10.2.2</p>
<p>202 &nbsp;&nbsp;&nbsp; Accepted &nbsp;&nbsp;&nbsp; 10.2.3</p>
<p>203 &nbsp;&nbsp;&nbsp; Non-Authoritative Information &nbsp;&nbsp;&nbsp; 10.2.4</p>
<p>204 &nbsp;&nbsp;&nbsp; No Content &nbsp;&nbsp;&nbsp; 10.2.5</p>
<p>205 &nbsp;&nbsp;&nbsp; Reset Content &nbsp;&nbsp;&nbsp; 10.2.6</p>
<p>206 &nbsp;&nbsp;&nbsp; Partial Content &nbsp;&nbsp;&nbsp; 10.2.7</p>
<p>3xx &nbsp;&nbsp;&nbsp; Redirection &nbsp;&nbsp;&nbsp; 10.3</p>
<p>300 &nbsp;&nbsp;&nbsp; Multiple Choices &nbsp;&nbsp;&nbsp; 10.3.1</p>
<p>301 &nbsp;&nbsp;&nbsp; Moved Permanently &nbsp;&nbsp;&nbsp; 10.3.2</p>
<p>302 &nbsp;&nbsp;&nbsp; Found &nbsp;&nbsp;&nbsp; 10.3.3</p>
<p>303 &nbsp;&nbsp;&nbsp; See Other &nbsp;&nbsp;&nbsp; 10.3.4</p>
<p>304 &nbsp;&nbsp;&nbsp; Not Modified &nbsp;&nbsp;&nbsp; 10.3.5</p>
<p>305 &nbsp;&nbsp;&nbsp; Use Proxy &nbsp;&nbsp;&nbsp; 10.3.6</p>
<p>306 &nbsp;&nbsp;&nbsp; (Unused) &nbsp;&nbsp;&nbsp; 10.3.7</p>
<p>307 &nbsp;&nbsp;&nbsp; Temporary Redirect &nbsp;&nbsp;&nbsp; 10.3.8</p>
<p>4xx &nbsp;&nbsp;&nbsp; Client Error &nbsp;&nbsp;&nbsp; 10.4</p>
<p>400 &nbsp;&nbsp;&nbsp; Bad Request &nbsp;&nbsp;&nbsp; 10.4.1</p>
<p>401 &nbsp;&nbsp;&nbsp; Unauthorized &nbsp;&nbsp;&nbsp; 10.4.2</p>
<p>402 &nbsp;&nbsp;&nbsp; Payment Required &nbsp;&nbsp;&nbsp; 10.4.3</p>
<p>403 &nbsp;&nbsp;&nbsp; Forbidden &nbsp;&nbsp;&nbsp; 10.4.4</p>
<p>404 &nbsp;&nbsp;&nbsp; Not Found &nbsp;&nbsp;&nbsp; 10.4.5</p>
<p>405 &nbsp;&nbsp;&nbsp; Method Not Allowed &nbsp;&nbsp;&nbsp; 10.4.6</p>
<p>406 &nbsp;&nbsp;&nbsp; Not Acceptable &nbsp;&nbsp;&nbsp; 10.4.7</p>
<p>407 &nbsp;&nbsp;&nbsp; Proxy Authentication Required &nbsp;&nbsp;&nbsp; 10.4.8</p>
<p>408 &nbsp;&nbsp;&nbsp; Request Timeout &nbsp;&nbsp;&nbsp; 10.4.9</p>
<p>409 &nbsp;&nbsp;&nbsp; Conflict &nbsp;&nbsp;&nbsp; 10.4.10</p>
<p>410 &nbsp;&nbsp;&nbsp; Gone &nbsp;&nbsp;&nbsp; 10.4.11</p>
<p>411 &nbsp;&nbsp;&nbsp; Length Required &nbsp;&nbsp;&nbsp; 10.4.12</p>
<p>412 &nbsp;&nbsp;&nbsp; Precondition Failed &nbsp;&nbsp;&nbsp; 10.4.13</p>
<p>413 &nbsp;&nbsp;&nbsp; Request Entity Too Large &nbsp;&nbsp;&nbsp; 10.4.14</p>
<p>414 &nbsp;&nbsp;&nbsp; Request-URI Too Long &nbsp;&nbsp;&nbsp; 10.4.15</p>
<p>415 &nbsp;&nbsp;&nbsp; Unsupported Media Type &nbsp;&nbsp;&nbsp; 10.4.16</p>
<p>416 &nbsp;&nbsp;&nbsp; Requested Range Not Satisfiable &nbsp;&nbsp;&nbsp; 10.4.17</p>
<p>417 &nbsp;&nbsp;&nbsp; Expectation Failed &nbsp;&nbsp;&nbsp; 10.4.18</p>
<p>5xx &nbsp;&nbsp;&nbsp; Server Error &nbsp;&nbsp;&nbsp; 10.5</p>
<p>500 &nbsp;&nbsp;&nbsp; Internal Server Error &nbsp;&nbsp;&nbsp; 10.5.1</p>
<p>501 &nbsp;&nbsp;&nbsp; Not Implemented &nbsp;&nbsp;&nbsp; 10.5.2</p>
<p>502 &nbsp;&nbsp;&nbsp; Bad Gateway &nbsp;&nbsp;&nbsp; 10.5.3</p>
<p>503 &nbsp;&nbsp;&nbsp; Service Unavailable &nbsp;&nbsp;&nbsp; 10.5.4</p>
<p>504 &nbsp;&nbsp;&nbsp; Gateway Timeout &nbsp;&nbsp;&nbsp; 10.5.5</p>
<p>505 &nbsp;&nbsp;&nbsp; HTTP Version Not Supported &nbsp;&nbsp;&nbsp; 10.5.6</p>
<p>6xx &nbsp;&nbsp;&nbsp; Proxy Error &nbsp;&nbsp;&nbsp; N/A</p>
<p>600 &nbsp;&nbsp;&nbsp; Unparseable Response Headers (Squid-specific) &nbsp;&nbsp;&nbsp; N/A</p>
<p>假如Squid从原始服务器没有接受到任何响应，你可在access.log里看到状态码0。假如Squid接受到的响应没有包含HTTP头部，就会出现状态码600。在少数情况下，某些原始服务器仅发送响应body，而忽略了任何头部。</p>
<p>13.2.3 access.log对端编码</p>
<p>下列编码可能出现在access.log的第9域。请参考10.10节关于Squid如何对cache丢失情况，选择有效的下一跳。</p>
<p>NONE</p>
<p>这指明Squid对本次请求，不会与任何其他服务器（邻居或原始服务器）通信。它通常与cache命中、拒绝请求、cache管理请求、错误、和所有的ICP查询这些类型联合出现。</p>
<p>DIRECT</p>
<p>Squid直接转发请求到原始服务器。该域的第2半部分显示原始服务器的IP地址，或主机名-假如禁止了log_ip_on_direct。</p>
<p>SIBLING_HIT</p>
<p>在姐妹cache返回ICP或HTCP命中后，Squid发送请求到姐妹cache。</p>
<p>PARENT_HIT</p>
<p>在父cache返回ICP或HTCP命中后，Squid发送请求到父cache。</p>
<p>DEFAULT_PARENT</p>
<p>Squid选择该父cache，因为其在squid.conf的cache_peer行里被标志为default。</p>
<p>FIRST_UP_PARENT</p>
<p>Squid转发请求到该父cache，因为它是位于已知活跃列表里的第一个父cache。</p>
<p>FIRST_PARENT_MISS</p>
<p>Squid转发请求到该父cache，它第一个响应ICP/HTCP丢失消息。换句话说，对这个特殊的ICP/HTCP查询，在这个特殊时刻，被选中的父cache有最佳的往返时间（RTT）。注意标准RTT可能被人工矫正过，取决于cache_peer指令的weight选项。</p>
<p>CLOSEST_PARENT_MISS</p>
<p>Squid选择该父cache，因为它报告到原始服务器的RTT最低。这点仅在2个cache都激活了netdb，并且原始服务器（或在同一子网内的其他server）返回ICMP ping消息。</p>
<p>CLOSEST_PARENT</p>
<p>这点类似CLOSEST_PARENT_MISS，除了RTT计算不是来自ICP/HTCP响应消息外。代替的，它们来自Squid保留的更老的计算方式，例如netdb交换功能。</p>
<p>CLOSEST_DIRECT</p>
<p>Squid基于netdb算法，转发请求到原始服务器。这点在满足下述任何条件时发生：</p>
<p>&nbsp;&nbsp;&nbsp; * 1）在Squid和原始服务器之间的RTT小于配置的minimum_direct_rtt值。</p>
<p>&nbsp;&nbsp;&nbsp; * 2）在Squid和原始服务器之间的标准路由跳数少于配置的minimum_direct_hops值。</p>
<p>&nbsp;&nbsp;&nbsp; * 3）在ICP/HTCP响应里返回的RTT值，指示Squid离原始服务器近于任何其他邻居。</p>
<p>ROUNDROBIN_PARENT</p>
<p>Squid转发请求到该父cache，因为设置了round-robin选项，并且它有最低的使用计数器。</p>
<p>CD_PARENT_HIT</p>
<p>Squid基于cache摘要算法（见10.7节）转发请求到该父cache。</p>
<p>CD_SIBLING_HIT</p>
<p>Squid基于cache摘要算法转发请求到该姐妹cache。</p>
<p>CARP</p>
<p>Squid选择该父cache，基于cache数组路由协议算法（见10.9节）。</p>
<p>ANY_PARENT</p>
<p>作为最后的手段，Squid选择该父cache，因为没有其他方法能选择可行的下一跳。</p>
<p>注意大部分上述编码可能以TIMEOUT_开头，这表明在等待ICP/HTCP响应时发生超时。例如：</p>
<p>可使用icp_query_timeout指令来调整超时。</p>
<p>&nbsp;</p>
</div><footer class="post__foot u-cf"><a href="/2009/06/16/w/squid-iptables-e9-80-8f-e6-98-8e-e4-bb-a3-e7-90-86-qq-e3-80-81msn-e4-b8-8d-e8-83-bd-e7-99-bb-e5-bd-95-e8-a7-a3-e5-86-b3-e5-8a-9e-e6-b3-95/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-05-25T07:04:08.000Z" class="post__time">五月 25, 2009</time><h1 class="post__title"><a href="/2009/05/25/w/centos-linux-e6-ba-90-e4-bb-a3-e7-a0-81-e7-bc-96-e8-af-91-e5-ae-89-e8-a3-85-e6-9c-80-e6-96-b0-e7-89-88amule/">centos linux 源代码编译安装最新版amule</a></h1></header><div class="post__main"><p>aMule是Linux下最佳的P2P软件之一，可应用eDonkey网络协议，也支持KAD网络，支持模糊协议（obfuscation）。</p>
<p>yum install wxGTK*</p>
<p>yum install cryptopp</p>
<p>yum install cryptopp-devel</p>
<p>tar xfj aMule-2.2.6.tar.bz2 -C /usr/local/src</p>
<p>cd /usr/local/src/aMule-2.2.6</p>
<p>./configure —disable-debug —enable-optimize —enable-webserver —enable-amule-daemon \</p>
<p>—enable-utf8-systray —enable-geoip —enable-unicode —enable-amulecmd —enable-amule-gui \</p>
<p>—enable-cas —enable-wxcas —enable-alc —enable-alcc —enable-amule-utils —disable-upnp</p>
<p>make -j6 &amp;&amp; make install</p>
<h1 id="—enable-alc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_compile_aMuleLinkCreator_GUI_version">—enable-alc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; compile aMuleLinkCreator GUI version</h1><p>如果编译报错graphics.c:95: undefined reference to `gdImageJpeg&#39; collect2: ld returned 1 exit status</p>
<p>取消—enable-alc</p>
<p>./configure —disable-debug —enable-optimize —enable-webserver —enable-amule-daemon —enable-utf8-systray —enable-geoip —enable-unicode —enable-amulecmd —enable-amule-gui —enable-cas —enable-wxcas —enable-alcc —enable-amule-utils —disable-upnp</p>
<p>&nbsp;</p>
<p>附:wxGTK、cryptopp源代码安装方法</p>
<p>export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig:/usr/lib/pkgconfig:/usr/local/pkgconfig:/usr/X11R6/lib/pkgconfig</p>
<p>wget <a href="http://heanet.dl.sourceforge.net/sourceforge/wxwindows/wxWidgets-2.8.8.tar.bz2" target="_blank" rel="external">http://heanet.dl.sourceforge.net/sourceforge/wxwindows/wxWidgets-2.8.8.tar.bz2</a></p>
<p>tar xfj wxWidgets-2.8.8.tar.bz2</p>
<p>cd wxWidgets-2.8.8</p>
<p>./configure —enable-unicode</p>
<p>make -j6 &amp;&amp; make install</p>
<p>ldconfig</p>
<p>wget <a href="http://www.cryptopp.com/cryptopp552.zip" target="_blank" rel="external">http://www.cryptopp.com/cryptopp552.zip</a></p>
<p>mkdir crypto ; mv cryptopp552.zip ./crypto</p>
<p>cd crypto ; unzip cryptopp552.zip</p>
<p>make &amp;&amp; cp libcryptopp.a /usr/lib/</p>
<p>mkdir /usr/include/cryptopp &amp;&amp; cp *.h /usr/include/cryptopp/</p>
<p>ldconfig</p>
<p><span id="ctl00_MainContentPlaceholder_ctl01_ctl00_lblEntry">amule关联firefox，修改about:config只能作用于firefox2.x的:</span></p>
<p>新建一个字符串：network.protocol-handler.app.ed2k 值：/usr/bin/ed2k</p>
<pre><code>新建一个布尔串：network<span class="class">.protocol-handler</span><span class="class">.external</span><span class="class">.ed2k</span> 值：true

新建一个布尔串：network<span class="class">.protocol-handler</span><span class="class">.warn-external</span><span class="class">.ed2k</span> 值：true&lt;span&gt;

对于firefox3.x，只要打开首选项，在应用程序设置里面，指定ed2k到/usr/bin/ed2k就万事大吉。&lt;/span&gt;
</code></pre><p><span>amule优化:</span></p>
<p><span>勾选</span><span>启动时自动更新服务器列表，。并且点击&ldquo;列表&rdquo;。添加如下服务器：</span></p>
<pre><code><span class="attribute">ed2k</span>:<span class="comment">//server|no1.eserver.emule.org.cn|8080|</span>

<span class="attribute">ed2k</span>:<span class="comment">//server|no2.eserver.emule.org.cn|8080|</span>

<span class="attribute">http</span>:<span class="comment">//www.emule.org.cn/server.met</span>

<span class="attribute">http</span>:<span class="comment">//www.srv1000.com/x1/server.met</span>

<span class="attribute">http</span>:<span class="comment">//emule.945.cn/server.met</span>

<span class="attribute">http</span>:<span class="comment">//www.edk-files.com/x1/server.met</span>

<span class="attribute">http</span>:<span class="comment">//corpo.free.fr/server.met&lt;/span&gt;</span>
</code></pre></div><footer class="post__foot u-cf"><a href="/2009/05/25/w/centos-linux-e6-ba-90-e4-bb-a3-e7-a0-81-e7-bc-96-e8-af-91-e5-ae-89-e8-a3-85-e6-9c-80-e6-96-b0-e7-89-88amule/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-05-25T02:23:11.000Z" class="post__time">五月 25, 2009</time><h1 class="post__title"><a href="/2009/05/25/w/centos-linux-yum-e4-b8-8d-e8-83-bd-e4-bd-bf-e7-94-a8-e7-9a-84-e8-a7-a3-e5-86-b3-e6-96-b9-e6-b3-95/">centos linux yum 不能使用的解决方法</a></h1></header><div class="post__main"><p>yum报错:</p>
<p>rpmdb: Lock table is out of available locker entries</p>
<p>rpmdb: Unknown locker ID: bc1</p>
<p>error: db4 error(22) from db-&gt;close: Invalid argument</p>
<p>error: cannot open Packages index using db3 - Cannot allocate memory (12)</p>
<p>error: cannot open Packages database in /var/lib/rpm</p>
<p>TypeError: rpmdb open failed</p>
<p>解决方法A:</p>
<p>备份rpm所用的数据库</p>
<p>cd /var/lib/rpm/</p>
<p>mv __db.* ~/</p>
<p>重建该数据库</p>
<p>rpm —rebuilddb</p>
<h1 id="yum_clean_all">yum clean all</h1><p>yum search fastestmirror</p>
<p>yum install yum-fastestmirror.noarch</p>
<p>如果一切正常</p>
<p>删除_db.*</p>
<p>rm -f ~/__db.*</p>
<p>&nbsp;</p>
</div><footer class="post__foot u-cf"><a href="/2009/05/25/w/centos-linux-yum-e4-b8-8d-e8-83-bd-e4-bd-bf-e7-94-a8-e7-9a-84-e8-a7-a3-e5-86-b3-e6-96-b9-e6-b3-95/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-05-12T08:01:22.000Z" class="post__time">五月 12, 2009</time><h1 class="post__title"><a href="/2009/05/12/w/e8-bf-87-e5-8d-88-e4-b8-8d-e9-a3-9f-e7-9a-84-e5-88-a9-e7-9b-8a/">过午不食的利益</a></h1></header><div class="post__main"><p>现代人开始崇尚断食了，其实过午不食或者日中一食就是一种每日进行的最有效的断食。</p>
<p>《律海十门》八戒近住分别门第四云：</p>
<p>一日夜不晚黄昏食，若过中食界限，乃至明日东方日出之间，于干饭、饼饽汤面等熟食之食物弃舍不食，则身安息调、健康永年、世福绵远、悲他有情、而后速出三界。一切有情皆依食住，能减饮食习气，则世系渐脱故。</p>
<p>《佛遗教经》云：汝等比丘，受诸饮食，当如服药，于好于恶，勿生增减。趣得支身，以除嫌渴。如蜂采华，但取其味，不损色身。比丘亦耳，受人供养，趣自除恼，无得多求，坏其善心。譬如智者，筹量牛力所堪多少，不令过分，以竭其力。</p>
<p>一般胎儿在母亲的子宫里是用肚脐吸取养分，胎儿脐带会跳动。婴孩则用腹部呼吸，人越长越大则呼吸点上移至胃中部，最后老人气弱则用肺部短程呼吸。我们修行所要做的第一件事，是要恢复用腹部呼吸。腹式呼吸就能把丹田开发出来，但若吃得太多，则会堵死丹田契机，故持过午不食的好处，即能让丹田复活。</p>
<p>根据中医子午流注：</p>
<p>子时（23-01）：胆把胆汁给换了，人就有一个清楚的大脑；</p>
<p>丑时（01-03），肝把血给了，产生新鲜血液（子、丑时最好进行右卧睡眠利于健康）；</p>
<p>到了寅时（03-05）（可以起床了）把血供给肺，肺朝百脉，也就是把营养和氧气输送给了全身，所以人醒了以后，脸色是非常好的；</p>
<p>当卯时（05-07）醒了，人该排泄了，这时大肠经开了，排泄干净了；</p>
<p>辰时（07-09），该吃饭了，胃经开了，利于消化；</p>
<p>巳时（09-11），消化完了该营养了，脾经这时动了；</p>
<p>午时（11-13），血液大量供给了心经，心经很旺，烈阳当空，在这种情况下，一气哈成；</p>
<p>未时（13-15），小肠经开了，心为火，脾胃为土，火生土，午饭吃完了，小肠赶紧给吸收了；</p>
<p>大量的水分要走掉，这时到了申时（15-17），膀胱经开了；</p>
<p>到了酉时（17-19），肾经开了，肾藏精华，也就是忙了一天，这时把一天的钱都存到这里来；</p>
<p>戌时（19-21），心包经开了，查一查有没有特务，也就是把一切邪的东西给清除掉；</p>
<p>亥时（21-23），三焦百脉都开了，需要休养生息了，人这时开始睡觉了。</p>
<p>过了中午阳气下降，阴气上升，吃了食物会使人阴气加重，早晨是天食，中午是佛食，晚上是鬼食。过中还食会使胃和大小内堆积垃圾，所以过中不食，是清肠的最好办法，因小肠和心互为表里，肠清则心清。</p>
<p>吃饭过饱或过了中午还吃饭，会使经脉不通，经脉不通，则身疲困乏、心地闭塞，则道业荒废。若5-7点吃晚饭，则使肾经不通，无法后转上升起命门火，形成秽污之精，肋长爱欲，接着7-9点使藏第八识之心包经不通，无法清除心脏周围邪气，久之，正居其内的心不能主神明，大脑思维被心包内之邪气所控制，接着 9-11点三焦百脉不通，11-凌晨3点胆肝负担重，解毒换血功能下降，严重时影响睡眠，到了第二天凌晨寅时阳气不易升起，到了卯时，肠道淤积的浊物难以排除，在体内形成毒素，进入血液和脏腑百骸，到了辰时巳时的最佳吸收营养阶段不思饮食，形成恶性循环，到了午时心负担重，阴阳相交不利。所以过午不食能保持头脑清醒，身心俱得明利轻快。</p>
<p>在方法上，可以先以水果或补气汤代替，再以水代替，进而达到完全过午不食。</p>
<p>过午不食的好处极多，是故佛陀制定之：</p>
<p>一、食欲少，能减低男女爱欲之心。</p>
<p>二、能得身心轻安，让肠胃得到适当休息。</p>
<p>三、易入禅定（梵语：dhyana）。</p>
<p>四、有更充分的时间可修行悟道。</p>
<p>五、欲得解脱（梵语：vimokso），食欲必得净化故。</p>
<p>六、三世诸佛皆依过午不食。</p>
<p>持过午不食有如上之好处，有理念而持午，人人皆可行之，持之以恒，即可得到持午之功德利益，无有限制。</p>
<p>什么样的饮食方式，对禅定有帮助？</p>
<p>持过午不食有如上所述之好处，有理念而持午，人人皆可行之，持之以恒，即可得到持午之功德与利益，无有限制。</p>
<p>什么样的饮食方式对禅定有帮助？</p>
<p>对初学者可改吃较清淡的饮食，调整营养分配的方式，渐渐改成素食，而且早上要吃的好，中午要吃的饱，晚餐要吃的少，绝不可吃宵夜。过阶者可慢慢的转换成过午不食（吃饭时间从早上5：00-下午1：00），先从每周一天过午不食，连续四周后再调整一次，最慢七个月内，就可渐渐习惯过午不食。</p>
<p>当连续一个月过午不食后，可停五天，接着再二个月过午不食，停五天，依此类推，到连续五个月过午不食，再休息五天，经过以上几个过程，就能稳住过午不食的习惯。</p>
<p>过午不食的修行，对禅定有极大的帮助，能净化我们的身体且可积累福报。</p>
<p>专业修行人的饮食方式，可从过午不食转成日中一食（吃饭时间从早上11：00-下午1：00），慢慢再缩短午餐时间（从中午12：00-1：00）。缩短时间的用意，是不要我们吃太多的食物，亦即虽日中一食是吃一顿饭的量，而非吃了三顿饭的量。</p>
<p>在饮食调整的过程中，可多念心经及施食，就此较不容易被心理或生理的饥饿困扰。</p>
<p>还有于农历初一、十五断食，可清除身体内的废物，对禅定也有极大帮助。</p>
<p>饮食营养该如何调配，才会对禅定有帮助？</p>
<p>食物的营养对于人，就如同对车子一样。车子要加油时，我们一定会加合适的、没有杂质的油，车子才能顺利运转，对于我们的包身也就是人身宝也要爱惜，不能吃不恰当的食物。</p>
<p>以下介绍不恰当的食物：</p>
<p>（1）人造的：如汽水、可乐、运动饮料等。</p>
<p>汽水、可乐会腐蚀牙齿，刺激胃酸，消耗身体中的钙质。运动饮料含钠离子太多，会造成身体电解质不平衡，加重肾脏负荷，特别是在晚上时喝。</p>
<p>（2）冰的：冰棒、雪糕、冷饮等。</p>
<p>低温的食物会刺激食道发炎、降低胃的蠕动率、以及阻滞气脉。</p>
<p>（3）刺激性的：烟、酒、咖啡、可可、茶及含咖啡因的饮料等。烟会阻塞气脉，酒会麻痹脑神经，咖啡会刺激心脏，可可对肾、肝，大肠不好，茶会刺激胃。</p>
<p>（4）烧、烤、油炸的：烧饼、油条、泡面对肝不好。</p>
<p>（5）不易消化的：油饭、炒饭、炒面因含有很多油，对胃不好。糯米饭因有黏性，对胃不好。</p>
<p>（6）太多调味料的：蒜、葱、辣椒、胡椒都人刺激口腔、食道及内脏。</p>
<p>（7）防霉剂、抗氧化剂、防腐剂等，含有这些东西的食物，会破坏肝、脑、神经系统，所以最好不要吃。</p>
<p>（8）蛋或蛋类制品：因为容易滋生细菌，所以最好不要吃。</p>
<p>以下介绍恰当的食物：</p>
<p>用粗盐取代酱油。以蒸者调理食物，比煎或炒更好。水：口渴时喝开过的温开水最好。</p>
<p>因每个人的积习难改，只要慢慢调整就会转变过来。再者，要细嚼慢咽，也非常重要，口腔嚼咀，需要能量较少；若狼吞虎咽进入胃里，需要较多能量，才能分解，处长了食物在身体的时间。</p>
<p>宋大诗人黄庭坚（山谷）信佛：早晨吃粥，中午吃饭，过午即不食。唐白居易《长庆集体》十九《龙华寺主家小尼》诗：[夜静双林怕，春深一食饑]却是对佛门弟子衷心悲悯的诗句。只是，古人认为过午不食也是长寿和保身养体的秘诀，并以为夜食过饱容易致病，宋人常年诀有这样几句顺口溜：[夜卧不蒙首，晚饭少数口]。意思就是晚上睡觉，最好不要蒙头大睡，蒙上了被子睡觉，空气不流通，对人健康不利。而吃饭呢，即使不遵守佛律——过午不食，但只要在吃饭时，不食饱，少吃几口饭，也是好的。</p>
<p>&nbsp;<a href="http://bbs.foyuan.net/thread-19532-1-2.html" target="_blank" rel="external">http://bbs.foyuan.net/thread-19532-1-2.html</a></p>
</div><footer class="post__foot u-cf"><a href="/2009/05/12/w/e8-bf-87-e5-8d-88-e4-b8-8d-e9-a3-9f-e7-9a-84-e5-88-a9-e7-9b-8a/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-05-12T07:01:10.000Z" class="post__time">五月 12, 2009</time><h1 class="post__title"><a href="/2009/05/12/w/e4-bd-8e-e6-b6-88-e8-b4-b9-e9-ab-98-e7-a6-8f-e5-88-a9-ef-bc-9a-e9-80-9a-e5-be-80-e7-94-9f-e6-80-81-e6-96-87-e6-98-8e-e4-b9-8b-e8-b7-af/">低消费高福利：通往生态文明之路</a></h1></header><div class="post__main"><p>摘要：人类改变现行的消费方式和生活方式，刻不容缓。但是追逐消费的观念和资本主导一切的逻辑，却如天罗地网般阻碍绿色生活方式的生存更甭提普及。必须实现从生产到生活到社会关系的全面转型，和谐社会、生态文明才有可能成功构建。 </p>
<p>一、转变消费&mdash;&mdash;生活方式的迫切性 </p>
<p>改变现行的消费方式和生活方式，是人类刻不容缓的任务，人们对此的怀疑已经越来越少了。在这里，我仅仅从地球生物承载力和生态足迹这个角度再明确强调一下。 </p>
<p>地球的生物承载力是指能满足人类需求的、可用的、具生物生产力的土地面积，包括农田、牧场、森林和渔场。生态足迹是按照生物学上一个地区的生产性土地 和海洋供人类使用和吸纳经人类使用后产生的废物所需要的资源，来衡量人类对大自然的需求。生物承载力和生态足迹通常以地球公顷为计量单位；全球平均1公顷 土地所能生产的资源和吸收的废物，就被称为&ldquo;1地球公顷&rdquo;单位。下表中的数据来自于世界自然基金会(WWF)、伦敦动物学会 (ZoologicalSociety of London)、全球足迹网络(Global Footprint Network)联合发布的《生命行星报告2006》(Living Planet Report 2006)。 </p>
<p>上表令我们一目了然的是，从全球来讲，把饼做大的空间已经不存在了，人类的生态足迹已经超出了地球负荷25％，我们早已不再依靠自然的&ldquo;利息&rdquo;生存， 而是在挥霍大自然的&ldquo;本金&rdquo;。即使如美国，地多人少，仍然超载100％以上。照目前这种消耗生态资源的速率走下去，发生生态系统全面崩溃的可能性不可避 免。2007年无锡水危机，淮河支流沙颍河沿岸的癌症村，越来越向北京逼近的沙漠，诸多现象，都是中国生态系统局部崩溃的表现。 </p>
<p>人类的生产方式和消费方式是不可持续的，必须迅速改变。自然界对人类的报复，日益明显。除去原有的生态灾难，近年来，气候危机的阴影开始笼罩地球，看似无毒无害的二氧化碳，竟然成为人类的头号环境敌人。 </p>
<p>美国奥巴马新政府公开承认气候危机的紧迫性并倡导发展低碳经济，这是比小布什政府进步之处。但是在倡导低碳经济的同时，奥巴马政府又向美国人民许诺， 要让他们继续过那种既有的美国式生活，住大房子开大汽车的生活。这完全是自相矛盾的。单从资源能源利用的效率来讲，今天的美国比50年前高效得多。可是， 随着效率的提高，房子越来越大(美国户均住房面积比50年前增长了一倍)，车子从经济型的小车换成了SUV，从一家一车变成一家两车甚至更多，结果资源能 源用得更多。与此同时，自我感觉幸福的美国人占总人口的比例，从上世纪70年代就进入平台期，近年来甚至有一些下降。仅仅采用新技术，而不改变美国人消费 主义的生活方式，怎么能真正实现减排、避免生态灾难? </p>
<p>近年来，中国政府开始超越单纯的GDP发展观，转而倡导科学发展观，主张可持续发展，要构建资源节约环境友好型社会，促进人与人、人与自然和谐共处的 新型文明&mdash;&mdash;生态文明。这一理念(更具体地说是发展理念)的转变是令人鼓舞的。尤其是近期来，中国政府更进一步明确提出要加快转变经济增长方式。但是问题 是，仅仅转变经济发展方式，是不足以完成向资源节约环境友好型社会的转变的。在中国，尽管人与资源环境的关系&ldquo;高度紧张&rdquo;，但是长期以来人们对住大房子开 大汽车的美国梦的向往却是空前热烈，即使真正实现了产业的升级优化，即使扩大了内需&mdash;&mdash;而非依赖现在的&ldquo;两高一资&rdquo;的外向型经济，只要中国人的美国梦一如 既往，可以预计：可持续发展依旧是镜花水月。从上面图表中的数据可以推算出，要满足全体中国人过上美国式的生活，至少需要1.12个地球。但无论是接轨， 还是发挥比较优势，还是&ldquo;大国崛起&rdquo;，或者什么主义和办法，都不可能变出1.12个地球给中国。 </p>
<p>可持续发展。离不开可持续消费，必须探索一条低消费高福利的发展之路。胡锦涛主席在十七大报告中强调：&ldquo;建设生态文明，基本形成节约能源资源和保护生 态环境的产业结构、增长方式、消费模式。&rdquo;将产业结构、增长方式、消费模式并列在一起，决不是一闪之念，而是深谋远虑之见。 </p>
<p>二、消费主义的误区 </p>
<p>由全球资本主义所主导的人类社会，遵循着两个原则。在生产领域，是企业的无止境的积累原则，为了追求利润不断地扩大再生产。为了让生产出来的产品有去 处，舆论上就引导人们不断地追逐消费。所谓&ldquo;能挣会花&rdquo;的宣传，实质上把生活等同于消费，用消费取代了生活。正常的生理需求变成了消费竞赛，人异化为一种 消费动物。人们疯狂地、辛苦地工作，就是为了享受那所谓消费的欢愉。只有消费者，才是成功者。你比别人消费得多，你就比别人更成功；你比别人消费得少，你 就是一个失败者。其实众多的研究证明，在满足了最基本的温饱之后，幸福感和消费基本上没有关联。过度消费并不能给人带来更多的幸福，相反却常常带给人烦 恼，即使暂不说其环境后果。2008年，一首叫做《那一年，我们都没有钱》的诗在网上广为流传，引爆众多网友争晒美好记忆。这印证了不少社会学家早就发现 的道理，幸福感并不随着消费的增加而增加。 </p>
<p>一个刚毕业不久的小姑娘，每月挣两千块，舍不得吃，舍不得租好房子，跟好几个人挤在一个房间里，辛辛苦苦省下钱来干嘛了?花三千多去买新型的诺基亚手 机，花几千块钱买IⅣ的手提包。以牺牲健康、舒适为代价，换来一时的炫耀所带来的对虚荣心的满足。攀比无止境，面对花上万元买更贵皮包者，虚荣心的满足往 往立刻变成沮丧。 </p>
<p>我一个朋友，在京郊买了一栋别墅，荣登&ldquo;别墅族&rdquo;之列。可是一年当中，除了中秋节召集一帮人撮一顿外，根本没有几天赶去享受。物业费还要照样交，一年下来差不多两万。别墅成了烫手山芋，现在想卖都卖不出去。 </p>
<p>与对这些奢侈品的过度追求相反，人们对那些虽非奢侈但是对人的生活至关重要的绿色产品。却又是极端轻视。同样一个小姑娘，她常常会花几百甚至几千元钱 去买一套所谓的高级护肤品，以图达到美容养颜的目的。其实各式各样的化妆品，不管是产自巴黎，还是北京郊区的某一个开发区的加工厂它们的差别并不大，都是 一些化工产品而已。它们对人的容颜的&ldquo;呵护&rdquo;微乎其微，有的甚至因为含有铅化物而有相当的副作用。真正的&ldquo;呵护&rdquo;是由内而外的，这个内，除了睡眠、运动 外，主要是由人的日常饮食决定的。绿色食品，由于其不用化肥农药，投入了较多的人力，所以价格自然会比非绿色食品要高。比如，普通大米一块一斤，绿色大米 可能三四块钱一厅。这个差价，对于许多对LV手提包和进口化妆品一掷千金的城里人来说，其实是负担得起的。可是，中国有机农产品，一半以上供出口&mdash;&mdash;这其 中的差价，大部分被中间商拿走，有机种植的农民得到的实惠很有限。中国农业大学的教授何慧丽组织兰考农民合作社生产无公害大米。好大米生产出来了，在销售 的过程中却困难重重，还惹来不少&ldquo;违背市场规律&rdquo;的嘲笑。人们宁愿花一千块钱买几十毫升的化学合成剂，却舍不得在善待农民的同时善待自己，多花一点钱买一 袋好大米，这难道就是神圣的市场规律?</p>
<p>&nbsp;</p>
<p>　　　　近些年来，中国城市中产阶级的环保意识越来越强，这是一件好事，但同时他们往往意识不到自己对环境污染的&ldquo;贡献&rdquo;。当中国入世的时候，多少城里人 为了汽车会因此降价而欢呼?中国越来越多的城市为了给小汽车开路，把主干道对自行车封闭。推动这一政策的出笼，当然是买车的城市中产阶级以及代表他们的利 益集团。一个朋友一面抱怨着北京的空气污染，一面说&ldquo;打算对自己好一点，买了一辆车&rdquo;，真是令人啼笑皆非。当我们用消费主义填补我们生活中的不满意时，有 没有想到，每多一辆车，要增加多少能源消耗，废气排放?有多少土地会被铺成马路?多少农民会因此失去土地?大自然因此失去多少自净化能力?私人汽车过多， 代步工具反倒成了累赘。我一个朋友，为了错过早晨的交通高峰，六点就起床，七点多开车赶到单位，代价是长期牺牲睡眠质量。在钢筋水泥的森林里穿行，开着车 到健身馆踩自行车锻炼身体的生活，真的就那么值得人神往吗?这是我们真正想要的还是被消费主义制造出来的? </p>
<p>低消费，并不意味着低生活水平。高福利是弥补之道。其实，生活不仅仅是消费。人类有很多需求，决不是消费能够代替或解决的。现在，金融危机一来，为了 拉动市场需求，各地纷纷组织家电下乡。农民真正需要什么呢?十几亿人呆坐在一个大盒子面前，看着同样的节目，这种&ldquo;现代性&rdquo;的可取之处到底有多少呢?湖北 三农学者贺雪峰教授几年前就提出，社会主义新农村建设应该是要建设一种&ldquo;低消费、高福利&rdquo;的不同于消费主义文化的生活方式，也就是要建设一种不用金钱作为 生活价值主要衡量标准，却可以提高农民满意度的生活方式。他的研究团队，在湖北几个村帮助农民建立老年人协会，每人每天只投入平均一毛钱，就极大地增进了 农村老年人之间的交往，提高了农村老年人闲暇生活的质量。老年人协会为老年人提供了老有所乐、老有所为的空间，使中青年人看得见未来的希望，从而降低了生 活的贴现率，提高了合作的可能性。同时，中老年妇女自发组织的各种文化组织，如腰鼓队、健美操队，不仅给农民带来了生活的情趣，而且使农村妇女有了生活的 主体性，增加了村庄的社会资本。所有这些，都不是彩电冰箱之类的家电能够取代的。毛泽东时代有人民体育、人民教育、大众文化和大众医疗的说法。农村改革， 是伴随着&ldquo;我们的家乡，在希望的田野上&rdquo;的歌声开始的。可是，将近三十年的经济高速发展，尽管农民有了电扇电视之类，农村却越来越成为让年轻人无所留恋的 空心村。究竟是什么地方出了问题?我们应该如何重建希望的田野?这几年政府大力重建农村合作医疗，大力投资农村基本教育，给社会主义新农村建设带来了曙 光。何慧丽、贺雪峰们的实践，对进一步深化新农村建设有相当的启发意义。 </p>
<p>贺雪峰教授提出的低消费高福利的发展之路，不仅是中国农村的急需，也是全世界包括西方在内的急需。在中国一提到西方，很多人首先想到的是美国，美国= 西方。说句公道话，欧洲与美国还是有很大不同的。普通民众对开大汽车住大房子的向往程度，在欧洲远不及在中国。现在欧洲兴起了一股&ldquo;共享汽车运动&rdquo;，充分 提高一辆汽车的利用效率，由不同家庭不同的人一起使用，达到了节能减排的目的。越来越多的城市开辟了自行车专用道&mdash;&mdash;中国越来越多的城市把主干道对自行车 封闭，完全是和可持续发展背道而驰。荷兰首都阿姆斯特丹，是有名的自行车之城，我给几个自行车停车场拍了照片。在国内参与公共活动时，我多次拿出这些照片 询问大家这是什么地方。答案是东南亚某城市，或者十几年前的中国某城市。当我说出正确的答案时，举座哗然。 </p>
<p>即使在美国，对极端消费主义的反思和批判也要远远强于中国。一位美国朋友曾送我的一句话：&ldquo;一个地球已经不可能再负担富&rdquo;(One earth cannotafford the rich any more．)&mdash;&mdash;国内的&ldquo;学者&rdquo;们肯定会攻击这是&ldquo;仇富&rdquo;的&ldquo;民粹主义&rdquo;运动。他是一位志愿简单生活运动(voluntary simplicity)的实践者，而这个已经有上百万人参与的运动，还在不断壮大。为什么越来越多的美国人加入到这一运动中?因为他们意识到，在满足了基 本的温饱需要后，物质的增长往往并不能带来更多的幸福感；与其成为金钱和物质的奴隶，不如满足于简单的生活，同时把精力投入到其他层面的追求中。设想，中 国人以美国人的生活为富裕的标准，美国人又以比尔&middot;盖茨的生活为富裕的标准，有限的地球承担得起如此庞大无限的欲望吗?有出路吗?我想起了志愿简单生活运 动另一句著名的口号：&ldquo;简单生活，让其他人能够生活。&rdquo;(Live simply，so others can simply live．) </p>
<p>三、阻碍消费方式转变的制度因素 </p>
<p>不过，对资本所主导的全球经济发展模式所带来的巨大负面环境影响，许多人自发降低自己生态足迹的努力，只是杯水车薪。因为个人或小群体的选择和行动固 然重要，但它的影响力根本不能和制度、规划比拟。西方真正的环保主义者对过去几十年环保运动有着清醒的反思：&ldquo;我们赢得了一些战役，但我们正在输掉这场战 争。&rdquo; </p>
<p>比如，美国的许多城市是为小汽车设计的，而不是为行人设计的，没有小汽车简直寸步难行，这为人们选择环保的出行方式带来了巨大的限制和困难。同样的两 个寻找职业者，有车者的寻找范围很显然就会大，而无车者因为公共交通不发达，寻找范围自然就会小，结果可想而知。既然做一个环保践行者的代价是如此巨大， 那么指望绿色生活运动会全民化，怎么可能? </p>
<p>同样的问题在北京也越来越明显了。近年来，尽管北京在公共交通方面投入很大，但是对无车族却越来越不方便。我认识的一位德国朋友，过去五六年内工作生 活在北京，一直坚持骑自行车上班。几年内她的住所和工作地点都没有改变，但上下班所需要的时间却越来越长，要绕的路越来越多。这主要是因为最近一些年的道 路规划越来越围绕汽车而设计。就拿西直门一带为例，西直门立交桥是汽车交通枢纽，其周围则是公共交通枢纽。与私人汽车相比，这里的公共交通的便捷性如何 呢?假如你从西面乘公交车来要在西直门换乘地铁，因为隔着巨大的立交桥，你只能在离地铁车站很远的地方下车&mdash;&mdash;再往前就没有路口和车站了。如果你再提着行 李，那这一段路程就绝不会轻松。要是再碰上下雨，那会更加狼狈。私人汽车方便了，行人遭罪。记得作家张承志曾指出，北京的那些立交桥纵横蔓延的巨大路口， 在行人眼里简直就是&ldquo;形如天堑&rdquo;。面对这样的公交系统，你又会做何种选择呢?你还会热衷于绿色出行吗?显然，类似的问题必须靠政府和制度来解决，单靠个人 选择是不够的。 </p>
<p>再讲一个农村的例子。住房建设是目前中国农民最重要的消费支出。上世纪80年代中期到90年代初期发行的一套中国民居邮票，让许多人了解到中国传统民 居建筑是那么多姿多彩，富有创造性。可是，在经济越来越发达的今天，八亿农民的住房却越来越如出一辙。从四川到贵州，从江南到西藏，清一色的砖墙贴瓷砖， 冬冷夏热，缺乏抗震能力。而且盖一栋这样的房子，至少要消耗农民进城打工十年左右的积累。如果有一种住房能够融环保、价廉、漂亮、牢固、冬暖夏凉于一体， 那可能是中国农民的最佳选择。中国台湾建筑师谢英俊就为我们提供了这一选择。谢英俊的建筑，创造性地继承了传统(比如稻砖房土砖房之类)，讲究形态美，注 重建筑外观与自然景致的融合。施工过程中，遵循生态环保原则，因地制宜，就地取材，主要使用无污染、可回收的天然建材如石头、竹子、麦秸、稻草、木料等， 最多辅以少量轻质钢材。这种房子即使拆毁后，其材料或者可以继续使用，或者被自然界分解掉，不会产生建筑垃圾及污染，称得上是货真价实的&ldquo;可持续建筑&rdquo;。 </p>
<p>谢英俊的设计不仅材料成本低廉，人工成本也是如此。因为他在设计中尽可能地降低了施工技术含量，尽可能地去机械与工具化、专业化(设计除外)，让房主及 其邻里乡亲自己动手就可以完成大部分工序，而不需要求助于专门的建筑施工队。中国农村缺乏资金，但是不缺乏劳动力资源。这种合作建房，既为农民节省了资 金，又使农民在建房中形成了一种新的社区关系，可谓一举多得。 </p>
<p>这样一种近乎完美的建筑模式，推广过程中最大的困难是什么?不是别的，是农民的认同。那么多农民，明知道砖墙贴瓷砖的房子只是看起来光鲜，住起来冬冷 夏热，但为了攀比&ldquo;现代化&rdquo;和所谓的&ldquo;洋气&rdquo;，宁可多花钱也要盖这样的房子。所幸的是，谢英俊的合作建房模式以及他所设计的稻砖房，现在开始在兰考等地的 农民合作社里被推广。这让我们看到了突围的希望。 </p>
<p>结语 </p>
<p>资本和消费主义主导的逻辑，阻碍着绿色消费和绿色生活的产生与普及。以人为本，还是以钱为本，这是摆在中国政府、中国社会、中国民众面前的选择。要想 实现可持续发展。就必须实现从生产到生活到社会关系的全面转型。一个以内需为主的经济发展方式，不可能与一个忽视社会公正、两极分化的社会共存；节能减排 的生产模式，无法与住大房开大车的消费方式共存。诸种方面是互为因果互相促进的，离开了它们的全面发展，和谐社会、生态文明将劳而无功。在经济危机和环境 危机都愈演愈烈的今天，探索一条低消费高福利的发展之路，是中国和全世界的急需。</p>
<p>作者：文佳筠</p>
<p>原载：《绿叶》</p>
</div><footer class="post__foot u-cf"><a href="/2009/05/12/w/e4-bd-8e-e6-b6-88-e8-b4-b9-e9-ab-98-e7-a6-8f-e5-88-a9-ef-bc-9a-e9-80-9a-e5-be-80-e7-94-9f-e6-80-81-e6-96-87-e6-98-8e-e4-b9-8b-e8-b7-af/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2009-05-12T02:11:58.000Z" class="post__time">五月 12, 2009</time><h1 class="post__title"><a href="/2009/05/12/w/linux-ntp-ef-bc-88network-time-protocol-ef-bc-89-e6-9c-8d-e5-8a-a1-e5-99-a8-e9-85-8d-e7-bd-ae/">linux NTP（Network Time Protocol）服务器配置</a></h1></header><div class="post__main"><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 服务器记录文件以及其后的报告中的数据来评估组织的活动，包括防火墙和VPN安全相关的活动，带宽的使用，以及其他各种各样的记录、管理、确认、授权和会计职能。由于服务器记录的是来自不同主机的信息，因此时间的准确性显得非常必要，否则的话就可能出现不同的事件顺序和故障排除的根源问题，使得与时间有关的一切数据都变得毫无意义。即使是在路由器里，像路由器配置改变、接口状态、调制解调器事件、安全警报、环境条件、CPU处理过载等主要的配置事件和系统错误信息，都要有准确的时间戳，这些数据才有意义。</p>
<p>网络时间协议简介</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NTP（Network Time Protocol）是由美国德拉瓦大学的David L. Mills教授于1985年提出，除了可以估算封包在网络上的往返延迟外，还可独立地估算计算机时钟偏差，从而实现在网络上的高精准度计算机校时，它是设计用来在Internet上使不同的机器能维持相同时间的一种通讯协定。时间服务器（time server）是利用NTP的一种服务器，通过它可以使网络中的机器维持时间同步。在大多数的地方，NTP可以提供1-50ms的可信赖性的同步时间源和网络工作路径。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 网络时间协议（NTP）的详细说明在RFC-1305[Mills 1992]中。RFC-1305对 NTP协议自动机在事件、状态、转变功能和行为方面给出了明确的说明。它以合适的算法以增强时钟的准确性，并且减轻多个由于同步源而产生的差错，实现了准确性低于毫秒的时间服务，以满足目前因特网中路径量测的需要。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NTP 是一个跨越广域网或局域网的复杂的同步时间协议，它通常可获得毫秒级的精度。RFC2030[Mills 1996]描述了SNTP（Simple Network Time Protocol），目的是为了那些不需要完整NTP实现复杂性的主机，它是NTP的一个子集。通常让局域网上的若干台主机通过因特网与其他的NTP主机同步时钟，接着再向局域网内其他客户端提供时间同步服务。</p>
<ul>
<li>网络时间服务的工作模式</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o Sever/Client mode：用户向一个多几个服务器提出服务请求，根据所交换的信息，从中选择认为最准确的时间，并调整本地的时钟。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o Multicast/Broadcast mode：此种模式是适用于用在高速的LAN上。利用一个或多个服务器在固定的周期向某个多播地址做广播。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o Symmetric mode：二个以上的Server互相进行时间消息的通讯，可以互相校正对方的时间，以维持整个subnet的时间一致性。</p>
<ul>
<li>保持网络节点时间同步的机制</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o ntpdate 命令：此命令被用来立即同步客户端和服务器的时间。这是同步客户端和服务器的时间的最快方式。系统每次启动的时候会使用这个命令，用来确保客户端和服务器的时间的同步。这个命令通常指定一个NTP服务器作为一个参数，客户端的时钟被设置为和服务器的时间匹配。当这个命令使用多个NTP服务器作为参数时，客户端会使用最低级的NTP服务器。如果级别相等，客户端会使用加权平均数。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o ntpd守护进程：此进程在后台持续运行，并且会定时校验客户端的时钟和NTP服务器的时间。xntpd守护进程通常是在系统启动的时候启动。因为客户端的时钟可能产生漂移，以致与实际的NTP时钟有差异。xntpd守护进程会周期性地发送一个NTP服务器的网络请求，并且与客户端的时钟对比，在必要的时候修正客户端的时间，同时将时间差存到名为/etc/ntp.drift文件。默认的xntpd时间检查的间隔为64秒，在第一次检查的时候，客户端的时钟和NTP服务器上的时钟的差异会被记录下来，同时依靠这个时间差异来计划下一次检查。如果这个时间差异很大，下一次的时间检查会很快发生。如果这个差异很小，下一次的检查到来的时间会相应的延长。这样就避免每次都去查询网络中的时间服务器，从而可以减轻网络负载。查询NTP服务器的次数会慢慢变少。直到达到NTP请求的最小值。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; o 注：在命令行方式下，可以采用&quot;ntpd -q&quot;或者&quot;ntpdate [-b]&nbsp; pool.ntp.org&quot;进行对时。使用ntpd进行时间同步时，应事先配置好ntp.conf文件。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>
<h1 id="yum_update_ntp">yum update ntp</h1><p>vi /etc/ntp.conf</p>
<p>restrict default nomodify notrap noquery</p>
<h1 id="restrict_default_ignore_//忽略所有ntp要求封包">restrict default ignore //忽略所有ntp要求封包</h1><p>//如果restric 后面不带参数，表示可以允许全部权限</p>
<p>restrict 127.0.0.1</p>
<p>restrict 192.168.6.0 mask 255.255.255.0 nomodify notrap</p>
<h1 id="—-_OUR_TIMESERVERS_——-">—- OUR TIMESERVERS ——-</h1><p>server 0.pool.ntp.org</p>
<p>server 1.pool.ntp.org</p>
<p>server 2.pool.ntp.org</p>
<p>server pool.ntp.org</p>
<p>server 3.cn.pool.ntp.org</p>
<p>server 0.asia.pool.ntp.org</p>
<p>server&nbsp; 127.127.1.0&nbsp;&nbsp;&nbsp;&nbsp; # local clock</p>
<p>fudge&nbsp;&nbsp; 127.127.1.0 stratum 10</p>
<p>//driftfile 选项，则指定了用来保存系统时钟频率偏差的文件, ntpd程序使用它来自动地补偿时钟的自然漂移， 从而使时钟即使在切断了外来时源的情况下，仍能保持相当的准确度</p>
<p>driftfile /var/lib/ntp/drift</p>
<p>broadcastdelay&nbsp; 0.008</p>
<p>keys&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /etc/ntp/keys</p>
<p>logfile /var/log/ntp.log</p>
<p>/etc/init.d/ntpd restart</p>
<p>chkconfig —level 345 ntpd on</p>
<p>&nbsp;&nbsp;&nbsp; 使用下面的命令检查时间服务器同步的状态：</p>
<p>ntpq -p</p>
<p>&nbsp;&nbsp;&nbsp; 一个可以证明同步问题的证据是所有远程服务器的jitter值是4000并且delay和reach的值是0。</p>
<p>&nbsp;&nbsp;&nbsp; 可能的原因有：</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 配置文件中的restrict default ignore没有被注释</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 有防火墙阻断了与server之间的通讯</p>
<p>&nbsp;&nbsp;&nbsp; 此外每次重启NTP服务器之后大约要3－5分钟客户端才能与server建立正常的通讯连接，否则你执行ntpdate ip的时候将返回：</p>
<p>&nbsp;ntpdate: no server suitable for synchronization found</p>
<p>&nbsp;</p>
<hr>
<p>网络内其它服务器时间的同步:</p>
<p>每一刻钟同步一次</p>
<p>crontab -e</p>
<p><em>/15 </em> <em> </em> * root /usr/sbin/ntpdate 192.168.6.153 &gt; /dev/null 2&gt;&amp;1</p>
<p>&nbsp;</p>
</div><footer class="post__foot u-cf"><a href="/2009/05/12/w/linux-ntp-ef-bc-88network-time-protocol-ef-bc-89-e6-9c-8d-e5-8a-a1-e5-99-a8-e9-85-8d-e7-bd-ae/#comments" class="post__foot-link u-fr">评论</a></footer></article></main><aside class="site-aside"><div class="widget about"><div class="b"><div class="info u-cf"><img src="/avatar.jpg"><div class="text"> <p>dayu graceful</p><p>vegan</p><p>linux sysadm</p><p> <a href="dayu2829@sina.com" title="wiebo" class="weibo ico"></a><a href="kindquiet@qq.com" title="qq" class="qq ico"></a></p></div></div></div></div><div class="widget tags"><div class="h">categories</div><div class="b"> <ul><li><a href="/categories/计算机/">计算机</a><small>(136)</small></li><li><a href="/categories/佛法传统文化/">佛法传统文化</a><small>(18)</small></li><li><a href="/categories/健康/">健康</a><small>(13)</small></li><li><a href="/categories/学习/">学习</a><small>(3)</small></li><li><a href="/categories/网络/">网络</a><small>(1)</small></li><li><a href="/categories/佛法传统文化/健康/">健康</a><small>(1)</small></li></ul></div></div><div class="widget links"><div class="h">links</div><div class="b"> <ul><li><a href="http://www.enzymesos.com/">酵素Enzyme救地球</a></li><li><a href="http://www.osalt.com/">商业软件的开源替代品</a></li></ul></div></div></aside></section><footer class="site-foot"><div class="inner"><div class="site-copy u-fl">© 2015 dayu<bdi> ❤ Theme by <a href="http://riny.net" target="_blank">Bubblings</a></bdi></div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/page/13/" class="page-menu__link icon-arrow-left">prev</a></li><li class="page-menu__item"><a title="Next" href="/page/15/" class="page-menu__link icon-arrow-right">next</a></li></menu></div></footer><div id="back-top" title="返回顶部"></div><script src="/js/script.js"></script></body></html>