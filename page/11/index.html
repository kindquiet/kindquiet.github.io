<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="description" content="kindquiet"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="kindquiet素食勤俭敬老孝慈" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><title>kindquiet素食勤俭敬老孝慈</title><meta name="keywords" content="centos,素食"><meta name="description" content="kindquiet素食勤俭敬老孝慈"><script>var _hmt = _hmt || [];(function() {  var hm = document.createElement("script");  hm.src = "//hm.baidu.com/hm.js?33ec0e4a308e2f174e68f15c700d8b5d";  var s = document.getElementsByTagName("script")[0];   s.parentNode.insertBefore(hm, s);})();</script><link rel="stylesheet" href="/css/style.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="site-head"><div class="inner"><h1 class="site-title u-fl"><a href="/">kindquiet素食勤俭敬老孝慈</a></h1><nav class="site-nav u-fr"><ul class="site-nav__list"><li class="site-nav__item"><a href="/" class="site-nav__link">Home</a></li><li class="site-nav__item"><a href="/archives" class="site-nav__link">Archives</a></li></ul></nav></div></header><section class="site-content"><main class="site-main"><article class="post"><header class="post__head"><time datetime="2010-07-15T02:30:00.000Z" class="post__time">七月 15, 2010</time><h1 class="post__title"><a href="/2010/07/15/w/cacti-e7-9b-91-e6-8e-a7monitormysql-innodb-e6-95-b0-e6-8d-ae-e5-ba-93/">cacti监控(monitor)mysql InnoDB 数据库</a></h1></header><div class="post__main"><p>目前最好用的监控mysql InnoDB 数据库的方法之一</p>
<pre><code>http:<span class="comment">//code.google.com/p/mysql-cacti-templates/</span>

wget http:<span class="comment">//mysql-cacti-templates.googlecode.com/files/better-cacti-templates-1.1.7.tar.gz</span>

tar <span class="attribute">-xzf</span> better<span class="attribute">-cacti</span><span class="attribute">-templates</span><span class="subst">-</span><span class="number">1.1</span><span class="number">.7</span><span class="built_in">.</span>tar<span class="built_in">.</span>gz <span class="attribute">-C</span> /usr/<span class="built_in">local</span>/src

cd /usr/<span class="built_in">local</span>/src/better<span class="attribute">-cacti</span><span class="attribute">-templates</span><span class="subst">-</span><span class="number">1.1</span><span class="number">.7</span>

cp scripts/ss_get_mysql_stats<span class="built_in">.</span>php /usr/<span class="built_in">local</span>/www/html/cacti/scripts

cd /usr/<span class="built_in">local</span>/www/html/cacti/scripts

vim ss_get_mysql_stats<span class="built_in">.</span>php

<span class="variable">$mysql_user</span> <span class="subst">=</span> <span class="subst">&amp;</span><span class="variable">#39</span>;cacti<span class="subst">&amp;</span><span class="variable">#39</span>;;

<span class="variable">$mysql_pass</span> <span class="subst">=</span> <span class="subst">&amp;</span><span class="variable">#39</span>;cacti<span class="subst">&amp;</span><span class="variable">#39</span>;;

<span class="variable">$mysql_port</span> <span class="subst">=</span> <span class="number">3306</span>;

设置准备监控的数据库的账户相关信息

创建监控Mysql需要的账户以及权限

配置MySQL服务器，让cacti所在机器能够访问MySQL服务器的状态信息，必须拥有<span class="subst">&amp;</span>rdquo;process<span class="subst">&amp;</span>rdquo;权限。如果要监控InnoDB状态，还必须有<span class="subst">&amp;</span>rdquo;SUPER<span class="subst">&amp;</span>rdquo;权限。

grant process,super <span class="keyword">on</span> <span class="subst">*</span><span class="built_in">.</span><span class="subst">*</span> <span class="keyword">to</span> <span class="subst">&amp;</span><span class="variable">#39</span>;cacti<span class="subst">&amp;</span><span class="variable">#39</span>;@<span class="subst">&amp;</span><span class="variable">#39</span>;<span class="subst">%&amp;</span><span class="variable">#39</span>; identified <span class="keyword">by</span> <span class="subst">&amp;</span><span class="variable">#39</span>;cacti<span class="subst">&amp;</span><span class="variable">#39</span>;;

flush privileges;

帐号测试：

cd /usr/<span class="built_in">local</span>/www/html/cacti/scripts

php <span class="attribute">-q</span> <span class="built_in">.</span>/ss_get_mysql_stats<span class="built_in">.</span>php <span class="subst">--</span>host <span class="number">10.88</span><span class="number">.1</span><span class="number">.134</span> <span class="subst">--</span>items cv,cx,cy,cz <span class="subst">--</span>user cacti <span class="subst">--</span>pass cacti <span class="subst">--</span>port <span class="number">3306</span>

模板导入（<span class="keyword">Import</span> Templates）

在cacti管理界面导入模板cacti_host_template_x_mysql_server_ht_0<span class="number">.8</span><span class="number">.6</span>i<span class="attribute">-sver1</span><span class="number">.1</span><span class="number">.7</span><span class="built_in">.</span><span class="built_in">xml</span>。

Now <span class="keyword">import</span> the template files through your web browser<span class="built_in">. </span><span class="keyword">In</span> the Cacti web interface<span class="subst">&amp;</span><span class="variable">#39</span>;s Console tab, click <span class="keyword">on</span> the <span class="keyword">Import</span> Templates<span class="subst">&amp;</span>nbsp; <span class="keyword">link</span> <span class="keyword">in</span> the left sidebar<span class="built_in">. </span>Browse <span class="keyword">to</span> the directory containing the unpacked templates, <span class="keyword">select</span> the <span class="built_in">XML</span> file for the templates you<span class="subst">&amp;</span><span class="variable">#39</span>;re installing, <span class="literal">and</span> submit the form<span class="built_in">. </span><span class="keyword">In</span> our example, the file will be named something like cacti_host_template_x_mysql_server_ht_0<span class="number">.8</span><span class="number">.6</span>i<span class="attribute">-sver1</span><span class="number">.1</span><span class="number">.7</span><span class="built_in">.</span><span class="built_in">xml</span><span class="built_in">.

</span><span class="built_in">Data</span> Input Method

<span class="preprocessor">[</span>success<span class="preprocessor">]</span><span class="markup"> X Get MySQL Stats/MyISAM Indexes IM </span><span class="preprocessor">[</span>update<span class="preprocessor">]</span><span class="markup">

Data Template

</span><span class="preprocessor">[</span>success<span class="preprocessor">]</span><span class="markup"> X MyISAM Indexes DT </span><span class="preprocessor">[</span>update<span class="preprocessor">]</span><span class="markup">

Graph Template

</span><span class="preprocessor">[</span>success<span class="preprocessor">]</span><span class="markup"> X InnoDB Buffer Pool GT </span><span class="preprocessor">[</span>update<span class="preprocessor">]</span><span class="markup">

Host Template

</span><span class="preprocessor">[</span>success<span class="preprocessor">]</span><span class="markup"> X MySQL Server HT </span><span class="preprocessor">[</span>update<span class="preprocessor">]</span><span class="markup">

添加设备

创建Graph。在Console选项卡下的左侧菜单栏中选择Devices，为要监控的主机新建一个Devices或选择已有Devices。在 Associated Graph Templates中添加想要监控MySQL状态的Graph Templates（如X MySQL Connections GT模板）。并点击最上面的Create Graphs for this Host链接，在Graph Templates的选择框中选择X MySQL Connections GT,然后点击Create按钮。然后Create Graphs for this Host。</span>
</code></pre><p>参考：</p>
<pre><code><span class="attribute">http</span>:<span class="comment">//faemalia.net/mysqlUtils/</span>

<span class="attribute">http</span>:<span class="comment">//forums.cacti.net/about6108.html</span>
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/07/15/w/cacti-e7-9b-91-e6-8e-a7monitormysql-innodb-e6-95-b0-e6-8d-ae-e5-ba-93/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-07-13T06:13:48.000Z" class="post__time">七月 13, 2010</time><h1 class="post__title"><a href="/2010/07/13/w/iptables-e5-8c-b9-e9-85-8d-e5-a4-9a-e4-b8-aa-e6-ba-90ip-e5-9c-b0-e5-9d-80/">iptables 匹配多个ip地址</a></h1></header><div class="post__main"><p>如果有一组目的ip不走squid透明代理，端口为3128，比如测试服务器、本地地址等，不需要cache，如何实现？</p>
<pre><code>/etc/sysconfig/iptables

<span class="comment">*nat</span>

:PREROUTING ACCEPT [0:0]

:POSTROUTING ACCEPT [0:0]

:OUTPUT ACCEPT [0:0]

-A PREROUTING -i eth0 -p tcp -<span class="keyword">m</span> <span class="keyword">mark</span> --<span class="keyword">mark</span> 0x3 -<span class="keyword">m</span> tcp --dport 80 -j REDIRECT --to-ports 3128

-A POSTROUTING -s 172.16.8.0/255.255.254.0 -o eth1 -j SNAT --to-source 123.127.42.168

COMMIT&amp;nbsp;&amp;nbsp;&amp;nbsp; 

<span class="comment">*mangle</span>

:PREROUTING ACCEPT [0:0]

:<span class="keyword">INPUT</span> ACCEPT [0:0]

:FORWARD ACCEPT [0:0]

:OUTPUT ACCEPT [0:0]

:POSTROUTING ACCEPT [0:0]

-A PREROUTING -<span class="keyword">d</span> a.b.c.0/255.255.255.192 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x2

-A PREROUTING -<span class="keyword">d</span> a.b.c.0/255.255.255.192 -j <span class="literal">RETURN</span>

-A PREROUTING -<span class="keyword">d</span> <span class="keyword">e</span>.f.<span class="keyword">g</span>.128/255.255.255.192 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x2

-A PREROUTING -<span class="keyword">d</span> <span class="keyword">e</span>.f.<span class="keyword">g</span>.128/255.255.255.192 -j <span class="literal">RETURN</span>

-A PREROUTING -<span class="keyword">d</span> 172.16.8.0/255.255.254.0 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x2

-A PREROUTING -<span class="keyword">d</span> 172.16.8.0/255.255.254.0 -j <span class="literal">RETURN</span>

-A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 80 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x3

-A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 80 -j <span class="literal">RETURN</span>

-A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 443 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x3

-A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 443 -j <span class="literal">RETURN</span>

COMMIT

脚本：

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p udp -<span class="keyword">m</span> udp --dport 53 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x1

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p udp -<span class="keyword">m</span> udp --dport 53 -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -<span class="keyword">d</span> a.b.c.0/26 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x2

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -<span class="keyword">d</span> a.b.c.0/26 -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -<span class="keyword">d</span> <span class="keyword">e</span>.f.<span class="keyword">g</span>.128/26 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x2

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -<span class="keyword">d</span> <span class="keyword">e</span>.f.<span class="keyword">g</span>.128/26 -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -<span class="keyword">d</span> 172.16.8.0/23 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x2

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -<span class="keyword">d</span> 172.16.8.0/23 -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 80 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x3

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 80 -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 443 -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x3

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p tcp -<span class="keyword">m</span> tcp --dport 443 -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p udp -<span class="keyword">m</span> udp -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x6

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -p udp -<span class="keyword">m</span> udp -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span>&amp;nbsp; -t mangle -A PREROUTING -j <span class="keyword">MARK</span> --<span class="keyword">set</span>-<span class="keyword">mark</span> 0x7

<span class="label">$IPTABLES</span> -t mangle -A PREROUTING -j <span class="literal">RETURN</span>

<span class="label">$IPTABLES</span> -t nat -A POSTROUTING -s 172.16.8.0/23 -o <span class="label">$INET_LINK</span> -j SNAT --to <span class="label">$INET_IP</span>

<span class="label">$IPTABLES</span> -t nat -A PREROUTING -i <span class="label">$LAN_LINK</span> -p tcp -<span class="keyword">m</span> <span class="keyword">mark</span> --<span class="keyword">mark</span> 0x3 -<span class="keyword">m</span> tcp --dport 80 -j REDIRECT --to-ports 3128
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/07/13/w/iptables-e5-8c-b9-e9-85-8d-e5-a4-9a-e4-b8-aa-e6-ba-90ip-e5-9c-b0-e5-9d-80/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-07-06T06:23:15.000Z" class="post__time">七月 6, 2010</time><h1 class="post__title"><a href="/2010/07/06/w/e8-80-81-e6-97-a7-e7-b3-bb-e7-bb-9f-e8-af-b7-e8-b0-a8-e6-85-8e-e5-8d-87-e7-ba-a7gcc/">老旧系统请谨慎升级gcc</a></h1></header><div class="post__main"><p>一台centos 4.2系统，yum升级gcc时中途停止。发现postfix出错：</p>
<pre><code>maildrop -v

maildrop: /lib/tls/libc.so<span class="number">.6</span>: <span class="property">version</span> `GLIBC_2<span class="number">.4</span>&amp;<span class="comment">#39; not found (required by /lib/libgcc_s.so.1)</span>

试图编译maildrop报错：

configure: <span class="keyword">error</span>: <span class="keyword">in</span> `/usr/<span class="keyword">local</span>/src/maildrop-<span class="number">2.5</span><span class="number">.0</span>&amp;<span class="comment">#39;:</span>

configure: <span class="keyword">error</span>: C compiler cannot create executables

See `config.<span class="command">log</span>&amp;<span class="comment">#39; for more details.</span>

configure:<span class="number">3188</span>: checking whether <span class="keyword">the</span> C compiler works

configure:<span class="number">3210</span>: gcc&amp;nbsp;&amp;nbsp;&amp;nbsp; conftest.c&amp;nbsp; &amp;gt;&amp;amp;<span class="number">5</span>

/usr/lib/gcc/i386-redhat-linux/<span class="number">3.4</span><span class="number">.6</span>/libgcc_s.so: undefined <span class="keyword">reference</span> <span class="keyword">to</span> `__stack_chk_fail@GLIBC_2<span class="number">.4</span>&amp;<span class="comment">#39;</span>

collect2: ld returned <span class="number">1</span> <span class="keyword">exit</span> status

一时找不到centos <span class="number">4</span>的光盘，安装centos <span class="number">5</span>的gcc不能解决。

rpm -ihv <span class="comment">--force --nodeps gcc-4.1.2-48.el5.i386.rpm</span>

清除后重新update问题解决。

rpm -aq |grep libgcc

rpm -ev <span class="comment">--nodeps libgcc-4.1.2-44.el5</span>

yum update libgcc*
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/07/06/w/e8-80-81-e6-97-a7-e7-b3-bb-e7-bb-9f-e8-af-b7-e8-b0-a8-e6-85-8e-e5-8d-87-e7-ba-a7gcc/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-06-24T07:39:10.000Z" class="post__time">六月 24, 2010</time><h1 class="post__title"><a href="/2010/06/24/w/nfs-mount-permission-denied-e7-9a-84-e5-8f-af-e8-83-bd-e5-8e-9f-e5-9b-a0-e5-8f-8a-e8-a7-a3-e5-86-b3/">nfs  mount  permission denied的可能原因及解决</a></h1></header><div class="post__main"><p>当nfs客户端增加到十台时，clinet报错</p>
<pre><code><span class="symbol">mount:</span> <span class="number">10.168</span>.<span class="number">1.162</span><span class="symbol">:/data/iscsi/webapp</span> failed, reason given by <span class="symbol">server:</span> <span class="constant">Permission </span>denied

<span class="symbol">server:</span>

<span class="constant">Jun </span><span class="number">24</span> <span class="number">10</span><span class="symbol">:</span><span class="number">13</span><span class="symbol">:</span><span class="number">17</span> svr162 mountd[<span class="number">15431</span>]<span class="symbol">:</span> authenticated mount request from <span class="number">10.168</span>.<span class="number">1.176</span><span class="symbol">:</span><span class="number">1020</span> <span class="keyword">for</span> /data/iscsi/webapp (<span class="regexp">/data/iscsi</span><span class="regexp">/webapp)</span>
</code></pre><p>升级nfs server:</p>
<p>yum update nfs-utils&nbsp; portmap</p>
<pre><code>排除iptables防火墙、hosts.deny限制等原因，子网内所有服务器都有权限mount,

showmount -e <span class="number">10</span>.<span class="number">168</span>.<span class="number">1</span>.<span class="number">162</span>

/data/iscsi/webapp&amp;nbsp; <span class="number">10</span>.<span class="number">168</span>.<span class="number">1</span>.<span class="number">0</span>/<span class="number">24</span>

考虑是否超出了nfs服务器支持的客户端数量上限。查资料nfs属于无状态服务，没有数量限制。试过多种方法，终于解决，只要mount

nfsd on /<span class="keyword">proc</span>/fs/nfsd <span class="keyword">type</span> nfsd (rw)

you can solve the problem adding the following lines <span class="keyword">in</span> /etc/fstab on the server side:

nfsd /<span class="keyword">proc</span>/fs/nfsd nfsd <span class="type">auto</span>,defaults <span class="number">0</span> <span class="number">0</span>

sunrpc /<span class="keyword">var</span>/lib/nfs/rpc_pipefs rpc_pipefs <span class="type">auto</span>,defaults <span class="number">0</span> <span class="number">0</span>

<span class="type">Then</span> <span class="keyword">type</span> on the server

mount -a

<span class="type">And</span> <span class="keyword">try</span> to mount de resource <span class="keyword">in</span> the client
</code></pre><p><a href="http://www.linuxforums.org/forum/linux-networking/44779-nfs-permission-denied-error.html" target="_blank" rel="external">http://www.linuxforums.org/forum/linux-networking/44779-nfs-permission-denied-error.html</a></p>
</div><footer class="post__foot u-cf"><a href="/2010/06/24/w/nfs-mount-permission-denied-e7-9a-84-e5-8f-af-e8-83-bd-e5-8e-9f-e5-9b-a0-e5-8f-8a-e8-a7-a3-e5-86-b3/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-06-13T00:37:01.000Z" class="post__time">六月 13, 2010</time><h1 class="post__title"><a href="/2010/06/13/w/e5-9b-bd-e5-86-85-e7-9a-84centos-yum-e6-ba-90-e5-8f-8arpm-e4-bb-93-e5-ba-93/">中国国内的Centos yum源及rpm仓库</a></h1></header><div class="post__main"><p>yum search fastestmirror</p>
<pre><code>yum install yum-fastestmirror<span class="keyword">*</span> -y

yum update yum<span class="keyword">*</span>
</code></pre><p>yum update kernel*</p>
<pre><code><span class="title">yum</span> update
</code></pre><h1 id="centos_6">centos 6</h1><pre><code>rpm -<span class="constant">Uhv&amp;</span>nbsp; <span class="symbol">http:</span>/<span class="regexp">/pkgs.repoforge.org/rpmforge</span>-release/rpmforge-release-<span class="number">0</span>.<span class="number">5.3</span>-<span class="number">1</span>.el6.rf.x86_64.rpm

rpm -<span class="constant">Uhv </span><span class="symbol">http:</span>/<span class="regexp">/pkgs.repoforge.org/rpmforge</span>-release/rpmforge-release-<span class="number">0</span>.<span class="number">5.3</span>-<span class="number">1</span>.el6.rf.i686.rpm

<span class="comment">#&amp;nbsp; Red Hat Enterprise Linux 5 / i386:</span>

rpm -<span class="constant">Uhv </span><span class="symbol">http:</span>/<span class="regexp">/apt.sw.be/redhat</span><span class="regexp">/el5/en</span><span class="regexp">/i386/rpmforge</span><span class="regexp">/RPMS/rpmforge</span>-release-<span class="number">0</span>.<span class="number">5.3</span>-<span class="number">1</span>.el5.rf.i386.rpm
</code></pre><h1 id="Red_Hat_Enterprise_Linux_5_/_x86_64:">Red Hat Enterprise Linux 5 / x86_64:</h1><pre><code>rpm -<span class="constant">Uhv </span><span class="symbol">http:</span>/<span class="regexp">/apt.sw.be/redhat</span><span class="regexp">/el5/en</span><span class="regexp">/x86_64/rpmforge</span><span class="regexp">/RPMS/</span><span class="regexp">/rpmforge-release-0.5.3-1.el5.rf.x86_64.rpm</span>
</code></pre><h1 id="rpmfusion">rpmfusion</h1><pre><code>rpm -<span class="constant">Uvh </span><span class="symbol">http:</span>/<span class="regexp">/mirrors.163.com/rpmfusion</span><span class="regexp">/free/el</span><span class="regexp">/updates/testing</span><span class="regexp">/6/x</span>86_64/rpmfusion-free-release-<span class="number">6</span>-<span class="number">0</span>.<span class="number">1</span>.noarch.rpm

rpm -<span class="constant">Uvh </span><span class="symbol">http:</span>/<span class="regexp">/mirrors.163.com/rpmfusion</span><span class="regexp">/free/el</span><span class="regexp">/updates/</span><span class="number">6</span>/i386/rpmfusion-free-release-<span class="number">6</span>-<span class="number">1</span>.noarch.rpm

rpm -<span class="constant">Uvh </span><span class="symbol">http:</span>/<span class="regexp">/download1.rpmfusion.org/free</span><span class="regexp">/el/updates</span><span class="regexp">/6/x</span>86_64/rpmfusion-free-release-<span class="number">6</span>-<span class="number">1</span>.noarch.rpm
</code></pre><p><a href="http://download1.rpmfusion.org/free/el/updates/6/i386/rpmfusion-free-release-6-1.noarch.rpm" target="_blank" rel="external">http://download1.rpmfusion.org/free/el/updates/6/i386/rpmfusion-free-release-6-1.noarch.rpm</a></p>
<pre><code><span class="symbol">http:</span>/<span class="regexp">/download1.rpmfusion.org/nonfree</span><span class="regexp">/el/updates</span><span class="regexp">/6/i</span>386/rpmfusion-nonfree-release-<span class="number">6</span>-<span class="number">1</span>.noarch.rpm
</code></pre><p>启用remi RHEL6 yum源</p>
<pre><code>rpm -ivh <span class="string">http:</span><span class="comment">//rpms.famillecollet.com/enterprise/remi-release-6.rpm</span>
</code></pre><p>CentOS 中国科学技术大学 USTC mirror(每小时更新一次)</p>
<pre><code>http:<span class="comment">//centos.ustc.edu.cn/</span>

<span class="keyword">cd</span> /etc/yum.repos.<span class="literal">d</span>

mv CentOS-Base.repo&amp;nbsp; CentOS-Base.repo.<span class="keyword">save</span>-`date +%F`

wget http:<span class="comment">//centos.ustc.edu.cn/CentOS-Base.repo.5</span>

mv CentOS-Base.repo.5 CentOS-Base.repo

centos 4:

<span class="keyword">cd</span> /etc/yum.repos.<span class="literal">d</span>

mv CentOS-Base.repo&amp;nbsp; CentOS-Base.repo.<span class="keyword">save</span>

wget http:<span class="comment">//centos.ustc.edu.cn/CentOS-Base.repo</span>
</code></pre><p>sohu开源镜像站</p>
<pre><code><span class="string">http:</span><span class="comment">//mirrors.sohu.com/help/centos.html</span>

wget <span class="string">http:</span><span class="comment">//mirrors.sohu.com/help/CentOS-Base-sohu.repo</span>

yum makecache

生成缓存
</code></pre><p>网易开源镜像站</p>
<pre><code><span class="string">http:</span><span class="comment">//mirrors.163.com/.help/centos.html</span>

wget <span class="string">http:</span><span class="comment">//mirrors.163.com/.help/CentOS-Base-163.repo</span>

yum makecache

生成缓存
</code></pre><ul>
<li>rpmforge:</li>
</ul>
<p><a href="http://dag.wieers.com/rpm/FAQ.php#B4" target="_blank" rel="external">http://dag.wieers.com/rpm/FAQ.php#B4</a></p>
<pre><code><span class="symbol">http:</span>/<span class="regexp">/dag.wieers.com/rpm</span><span class="regexp">/packages/rpmforge</span>-release/

<span class="comment">#&amp;nbsp; Red Hat Enterprise Linux 5 / i386:</span>
</code></pre><p>rpm -Uhv <a href="http://apt.sw.be/redhat/el5/en/i386/rpmforge/RPMS/rpmforge-release-0.3.6-1.el5.rf.i386.rpm" target="_blank" rel="external">http://apt.sw.be/redhat/el5/en/i386/rpmforge/RPMS/rpmforge-release-0.3.6-1.el5.rf.i386.rpm</a></p>
<pre><code><span class="preprocessor"># Red Hat Enterprise Linux 5 / x86_64:</span>
</code></pre><p>rpm -Uhv <a href="http://apt.sw.be/redhat/el5/en/x86_64/rpmforge/RPMS//rpmforge-release-0.3.6-1.el5.rf.x86_64.rpm" target="_blank" rel="external">http://apt.sw.be/redhat/el5/en/x86_64/rpmforge/RPMS//rpmforge-release-0.3.6-1.el5.rf.x86_64.rpm</a></p>
<pre><code><span class="preprocessor"># Red Hat Enterprise Linux 4 / i386:</span>
</code></pre><p>rpm -Uhv <a href="http://apt.sw.be/redhat/el4/en/i386/rpmforge/RPMS/rpmforge-release-0.3.6-1.el4.rf.i386.rpm" target="_blank" rel="external">http://apt.sw.be/redhat/el4/en/i386/rpmforge/RPMS/rpmforge-release-0.3.6-1.el4.rf.i386.rpm</a></p>
<p>删除 32 位组件：</p>
<pre>yum remove \*.i\?86
</pre>

<p>要防止 32 位元组件在未来更新时被安装，请编辑你的 /etc/yum.conf 并加入以下一行：</p>
<pre>exclude = *.i?86
</pre>

<p>&nbsp;</p>
</div><footer class="post__foot u-cf"><a href="/2010/06/13/w/e5-9b-bd-e5-86-85-e7-9a-84centos-yum-e6-ba-90-e5-8f-8arpm-e4-bb-93-e5-ba-93/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-06-12T08:50:04.000Z" class="post__time">六月 12, 2010</time><h1 class="post__title"><a href="/2010/06/12/w/dd-rescue-e3-80-81ddrescue-e4-b8-8edd-e7-9a-84-e7-a3-81-e7-9b-98-e5-a4-8d-e5-88-b6-e9-80-9f-e5-ba-a6-e6-af-94-e8-be-83/">dd_rescue、ddrescue与dd的磁盘复制速度比较</a></h1></header><div class="post__main"><p>dd_rescue的速度是最快的。</p>
<p>下载：<a href="http://www.garloff.de/kurt/linux/ddrescue/" target="_blank" rel="external">http://www.garloff.de/kurt/linux/ddrescue/</a></p>
<p><a href="http://www.garloff.de/kurt/linux/ddrescue/dd_rescue-1.14.tar.gz" target="_blank" rel="external">http://www.garloff.de/kurt/linux/ddrescue/dd_rescue-1.14.tar.gz</a></p>
<p>解压make &amp;&amp; make install即可安装。</p>
<p>ddrescue 下载：<a href="http://www.gnu.org/software/ddrescue/ddrescue.html" target="_blank" rel="external">http://www.gnu.org/software/ddrescue/ddrescue.html</a></p>
<p>以下为在sata硬盘上的速度比较：</p>
<p>dd_rescue -v /dev/sda /dev/sdb</p>
<pre><code><span class="attribute">dd_rescue</span>: <span class="string">(info): about to transfer 0.0 kBytes from /dev/sda to /dev/sdb</span>

<span class="http"><span class="attribute">dd_rescue</span>: <span class="string">(info): blocksizes: soft 65536, hard 512</span>

<span class="http"><span class="attribute">dd_rescue</span>: <span class="string">(info): starting positions: in 0.0k, out 0.0k</span>

<span class="http"><span class="attribute">dd_rescue</span>: <span class="string">(info): Logfile: (none), Maxerr: 0</span>

<span class="groovy"><span class="string">dd_rescue:</span> (info): <span class="string">Reverse:</span> no , <span class="string">Trunc:</span> no , <span class="string">interactive:</span> no
<span class="label">
dd_rescue:</span> (info): abort on Write <span class="string">errs:</span> no , spArse <span class="string">write:</span> <span class="keyword">if</span> err
<span class="label">
dd_rescue:</span> (info): <span class="string">ipos:</span>&amp;nbsp; <span class="number">10870784.0</span>k, <span class="string">opos:</span>&amp;nbsp; <span class="number">10870784.0</span>k, <span class="string">xferd:</span>&amp;nbsp; <span class="number">10870784.0</span>k

&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="string">errs:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span>, <span class="string">errxfer:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0.0</span>k, <span class="string">succxfer:</span>&amp;nbsp; <span class="number">10870784.0</span>k

&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; +curr.<span class="string">rate:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">70586</span>kB<span class="regexp">/s, avg.rate:&amp;nbsp;&amp;nbsp;&amp;nbsp; 37040kB/</span>s, avg.<span class="string">load:</span> <span class="number">16.7</span>%</span></span></span></span>
</code></pre><p>&nbsp;</p>
<p>ddrescue -v —max-retries=-1 /dev/sda /dev/sdb</p>
<p>About to copy 81964 MBytes from /dev/sda to /dev/sdb</p>
<pre><code>&amp;nbsp;&amp;nbsp;&amp;nbsp; Starting <span class="string">positions:</span> infile = <span class="number">0</span> B,&amp;nbsp; outfile = <span class="number">0</span> B

&amp;nbsp;&amp;nbsp;&amp;nbsp; Copy block <span class="string">size:</span> <span class="number">128</span> hard blocks

Hard block <span class="string">size:</span> <span class="number">512</span> bytes
<span class="label">
Direct:</span> no&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="string">Sparse:</span> no&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="string">Split:</span> yes&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="string">Truncate:</span> no

Press Ctrl-C to interrupt
<span class="label">
rescued:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">16834</span> MB,&amp;nbsp; <span class="string">errsize:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span> B,&amp;nbsp; current <span class="string">rate:</span>&amp;nbsp;&amp;nbsp; <span class="number">27983</span> kB/s

&amp;nbsp;&amp;nbsp; <span class="string">ipos:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">16834</span> MB,&amp;nbsp;&amp;nbsp; <span class="string">errors:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span>,&amp;nbsp;&amp;nbsp;&amp;nbsp; average <span class="string">rate:</span>&amp;nbsp;&amp;nbsp; <span class="number">29795</span> kB/s

&amp;nbsp;&amp;nbsp; <span class="string">opos:</span>&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">16834</span> MB

Copying data...
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/06/12/w/dd-rescue-e3-80-81ddrescue-e4-b8-8edd-e7-9a-84-e7-a3-81-e7-9b-98-e5-a4-8d-e5-88-b6-e9-80-9f-e5-ba-a6-e6-af-94-e8-be-83/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-06-08T01:39:54.000Z" class="post__time">六月 8, 2010</time><h1 class="post__title"><a href="/2010/06/08/w/e6-b7-bb-e5-8a-a0spf-e8-ae-b0-e5-bd-95-e9-98-b2-e6-ad-a2-e5-9e-83-e5-9c-be-e9-82-ae-e4-bb-b6/">添加spf记录防止垃圾邮件</a></h1></header><div class="post__main"><p>SPF的完整意思为 &quot;Sender Policy Framework&quot;。翻译过来就是发送方策略框架，是一项跟 DNS 相关的技术，它的内容写在 DNS 的 txt 类型记录里面，关于更详细的信息请参考 RFC4408: <a href="http://www.ietf.org/rfc/rfc4408.txt" target="_blank" rel="external">http://www.ietf.org/rfc/rfc4408.txt</a></p>
<pre><code>SPF 的原理是使用电子邮件的头部信息中的 &amp;#<span class="number">39</span>;Return Path&amp;#<span class="number">39</span>; 或 &amp;#<span class="number">39</span>;Mail From&amp;#<span class="number">39</span>; 这两个邮件头里的域名来结合真正提供这个邮件的服务商 DNS 里面的记录去验证发送邮件服务器是否是冒充行为。

SPF 的官方网站是： <span class="string">http:</span><span class="comment">//www.openspf.org/</span>

SPF可以防止别人伪造你来发邮件，是一个反伪造性邮件的解决方案。当你定义了你的domain name的SPF记录之后，接收邮件方会根据你的SPF记录来确定连接过来的IP地址是否被包含在SPF记录里面，如果在，则认为是一封正确的邮件，否则则认为是一封伪造的邮件。关于更详细的信息请参考RFC4408（<span class="string">http:</span><span class="comment">//www.ietf.org/rfc/rfc4408.txt）</span>

如何增加SPF记录

非常简单，在DNS里面添加TXT记录即可。

举例：dig -t txt veryi.com.

&amp;quot;v=spf1 mx <span class="string">ip4:</span><span class="number">114.113</span><span class="number">.144</span><span class="number">.252</span> ~all&amp;quot;

v=spf1 &amp;nbsp;&amp;nbsp;&amp;nbsp; SPF 的版本。如果使用 Sender ID 的话，这个字段就应该是 v=spf2

返回值 &amp;nbsp;&amp;nbsp;&amp;nbsp; 描述

+ &amp;nbsp;&amp;nbsp;&amp;nbsp; 缺省值。在测试完成的时候表示通过。

- &amp;nbsp;&amp;nbsp;&amp;nbsp; 表示测试失败。这个值通常是 -all，表示没有其他任何匹配发生。

~ &amp;nbsp;&amp;nbsp;&amp;nbsp; 表示软失败，通常表示测试没有完成。

? &amp;nbsp;&amp;nbsp;&amp;nbsp; 表示不置可否。这个值也通常在测试没有完成的时候使用。

include &amp;nbsp;&amp;nbsp;&amp;nbsp; 包含一个给定的域名的测试

以 include:domain 的形式书写。

all &amp;nbsp;&amp;nbsp;&amp;nbsp; 终止测试序列。

比如，如果选项是 -all，那么到达这条记录也就意味着测试失败了。但是如果无法确定，可以使用&amp;quot;?all&amp;quot;来表示，这样，测试将被接受。

ip4 &amp;nbsp;&amp;nbsp;&amp;nbsp; 使用 IPv4 进行验证。

这个可以以 ip4:ipv4 或 <span class="string">ip4:</span>ipv4/cidr 的形式使用。建议使用这个参数，以减少域名服务器的负荷。

mx &amp;nbsp;&amp;nbsp;&amp;nbsp; 使用 DNS MX RR 进行验证。

MX RR 定义了收信的 MTA，这可能和发信的 MTA 是不同的，这种情况基于 mx 的测试将会失败。

可以用 <span class="string">mx:</span>domain, <span class="string">mx:</span>domain<span class="regexp">/cidr 或 mx/</span>cidr 这些形式进行 mx 验证。

如何查询某个域名是否开启SPF，可以使用以下命令：

# dig -t txt 域名

只需要去查询 TXT 类型的 DNS 记录即可。

SPF variables

v=spf1 / 表示 spf1 的版本

- Fail, 表示没有其他任何匹配发生

~ 代表软失败，通常用于测试中

? 代表忽略

IP4 代表IPv4进行验证

IP6 代表IPv6进行验证

all 代表结束

可以通过这个向导来设置自己的SPF记录http:<span class="comment">//old.openspf.org/wizard.html</span>
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/06/08/w/e6-b7-bb-e5-8a-a0spf-e8-ae-b0-e5-bd-95-e9-98-b2-e6-ad-a2-e5-9e-83-e5-9c-be-e9-82-ae-e4-bb-b6/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-05-19T06:03:12.000Z" class="post__time">五月 19, 2010</time><h1 class="post__title"><a href="/2010/05/19/w/centos-5-e5-ae-89-e8-a3-85-e4-bd-bf-e7-94-a8p2p-bittorrentbt-e4-b8-8b-e8-bd-bd-e5-b7-a5-e5-85-b7/">centos 5安装使用p2p Bittorrent(BT)下载工具</a></h1></header><div class="post__main"><p>使用rpmforge-release RPM packages for Red Hat, CentOS and Fedora:</p>
<p>wget <a href="http://dag.wieers.com/rpm/packages/rpmforge-release/rpmforge-release-0.3.6-1.el5.rf.x86_64.rpm" target="_blank" rel="external">http://dag.wieers.com/rpm/packages/rpmforge-release/rpmforge-release-0.3.6-1.el5.rf.x86_64.rpm</a></p>
<pre><code>rpm -ihv rpmforge-release-<span class="number">0.3</span>.<span class="number">6</span>-<span class="number">1</span><span class="class">.el5</span><span class="class">.rf</span><span class="class">.x86_64</span><span class="class">.rpm</span>
</code></pre><p>32位系统使用</p>
<p>wget <a href="http://dag.wieers.com/rpm/packages/rpmforge-release/rpmforge-release-0.3.6-1.el5.rf.i386.rpm" target="_blank" rel="external">http://dag.wieers.com/rpm/packages/rpmforge-release/rpmforge-release-0.3.6-1.el5.rf.i386.rpm</a></p>
<pre><code>rpm -ihv rpmforge-<span class="operator"><span class="keyword">release</span>-<span class="number">0.3</span><span class="number">.6</span>-<span class="number">1.</span>el5.rf.i386.rpm

&amp;nbsp;</span>
</code></pre><p>1、KTorrent是使用C++语言为KDE编写的BT客户端程序，其主要功能包括：</p>
<pre><code>　　支持UDP追踪；

　　IP地址黑名单插件；

　　UPnP端口转发（通用即插即用）；

　　协议加密；

　　支持&amp;mu;Torrent对等交换；

　　导入已部分下载的文件；

　　目录扫描，自动监视新的种子文件目录；

安装

yum <span class="operator"><span class="keyword">install</span> ktorrent

<span class="number">2</span>、rtorrent是利用libtorrent库创建的Ncurses客户端程序。使用C++语言编写的rtorrent除了能够提供基于GUI界面的客户端所具备的功能之外，其速度和效率更为用户所推崇。

&amp;nbsp;</span>&amp;nbsp;&amp;nbsp;&amp;nbsp; rtorrent的主要功能包括：

　　通过URL或文件路径添加种子，使用标签查看目录内容并自动完成；

安装

yum <span class="operator"><span class="keyword">install</span> rtorrent</span>
</code></pre><p>3、Vuze（Azureus）是一个跨平台的BT下载工具，需要JAVA环境 </p>
<pre><code>下载：

<span class="symbol">http:</span>/<span class="regexp">/sourceforge.net/projects</span><span class="regexp">/azureus/files</span><span class="regexp">/vuze/</span><span class="constant">Vuze_4404/Vuze_4404.</span>jar/download

&amp;nbsp;
</code></pre><p>4、deluge是一个跨平台的BT下载工具，需要python环境</p>
<p>下载：</p>
<p><a href="http://download.deluge-torrent.org/source/deluge-1.2.3.tar.bz2" target="_blank" rel="external">http://download.deluge-torrent.org/source/deluge-1.2.3.tar.bz2</a></p>
<p>5、qBittorrent的主要特性包括：</p>
<pre><code>　　使用Qt4工具包编写出优美的图形用户界面；

　　支持加密（与Azureus兼容）；

　　支持DHT网络；

　　支持&amp;mu;Torrent对等交换（PeX）；
</code></pre><p>下载：</p>
<p><a href="http://qbittorrent.sourceforge.net/download.php" target="_blank" rel="external">http://qbittorrent.sourceforge.net/download.php</a></p>
</div><footer class="post__foot u-cf"><a href="/2010/05/19/w/centos-5-e5-ae-89-e8-a3-85-e4-bd-bf-e7-94-a8p2p-bittorrentbt-e4-b8-8b-e8-bd-bd-e5-b7-a5-e5-85-b7/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-05-12T08:02:20.000Z" class="post__time">五月 12, 2010</time><h1 class="post__title"><a href="/2010/05/12/w/e7-94-a8nxserver-e4-bb-a3-e6-9b-bfvnc-server-e5-ae-9e-e7-8e-b0-e5-bf-ab-e9-80-9f-e8-bf-9c-e7-a8-8b-e6-a1-8c-e9-9d-a2-e7-ae-a1-e7-90-86/">用nxserver代替vnc-server实现快速远程桌面管理</a></h1></header><div class="post__main"><p>nx技术采取了新的远程协议，把x桌面的数据经过提取，仅传送一些参数，而且通过ssh来进行数据加密传送，因此相比VNC或直接XDMP具有很快的速度 和较高的安全性能。</p>
<p>&nbsp; centos 6，安装更新为：</p>
<p>yum install freenx nxproxy nxagent -y</p>
<p>否则报错：</p>
<p>Can&#39;t open /var/lib/nxserver/db/running/sessionId{…}: No such file or directory.</p>
<p>centos客户端安装：</p>
<p>yum install opennx -y</p>
<p>或者下载<a href="https://www.nomachine.com/download" target="_blank" rel="external">https://www.nomachine.com/download</a></p>
<p>&nbsp;</p>
<p>要点：</p>
<p>1、centos 5 yum安装的包是nx-3.4.0-3.el5.centos，freenx-0.7.3-3.el5.centos。</p>
<p>配置文件在/etc/nxserver</p>
<p>客户端的key的位置是</p>
<p>/var/lib/nxserver/home/.ssh/client.id_dsa.key</p>
<p>2、如果验证错误，可以重置key:</p>
<p>nxsetup —install —setup-nomachine-key —clean —purge</p>
<pre><code><span class="comment">nxsetup</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">install</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">setup</span><span class="literal">-</span><span class="comment">nomachine</span><span class="literal">-</span><span class="comment">key</span>
</code></pre><p>3. 对于centos 6，安装 NX / FreeNX ：</p>
<p>yum groupinstall Desktop -y</p>
<p>yum install nx freenx -y</p>
<p>You may also download the RPMS from:</p>
<pre><code><span class="symbol">http:</span>/<span class="regexp">/mirror.centos.org/centos</span><span class="regexp">/5/extras</span><span class="regexp">/i386/</span><span class="constant">RPMS/</span>

<span class="keyword">and</span> the <span class="constant">SRPMS </span><span class="symbol">from:</span>

<span class="symbol">http:</span>/<span class="regexp">/mirror.centos.org/centos</span><span class="regexp">/5/extras</span><span class="regexp">/SRPMS/</span>
</code></pre><p>Copy a minimal configuration file for nxserver :</p>
<p>cd /etc/nxserver ; cp node.conf.sample node.conf</p>
<p>nxsetup —install —setup-nomachine-key</p>
<pre><code>nxserver <span class="comment">--start</span>

&amp;nbsp;
</code></pre><p>4、如果是下载rpm包安装nxclient-3.4.0-7.i386.rpm,nxnode- 3.4.0-11.i386.rpm,nxserver-3.4.0-12.i386.rpm，</p>
<p>配置文件在/usr/NX/etc/，</p>
<p>执 行文件在/usr/NX/bin，初始化明令：</p>
<p>nxserver —install —setup-nomachine-key</p>
<p>5. Installing the NoMachine Client</p>
<pre><code>download <span class="keyword">from</span> http:<span class="comment">//www.nomachine.com/</span>
</code></pre><p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select the connection type, the desktop system you want to use(e.g. Gnome), and the size of the desktop. Also decide if you want to Encrypt all Traffic via SSL. If you use SSL, not only is the traffic encrypted, but it uses only the SSL port you list to make the connection. This means only the SSL port needs to be open to inbound traffic if you are connecting from outside a firewall. Select Next when finished.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; In the advanced dialog window under the General Tab, you should see the items you have already entered and a Key… button. You will need to ssh into the server which you are trying to connect and go to the /etc/nxserver/ directory and edit the file client.id_dsa.key (you must be the root user to open this file). Copy all the text (including the BEGIN DSA PRIVATE KEY and END DSA PRIVATE KEY lines. Press the Key… button, delete the text that is in there, and paste the client.id_dsa.key information from the server into the DSA Key text box (shown in yellow below}, then select Save. [attachment:nxclient4.png] [attachment:nxclient5.png]</p>
<p>6. Misc Notes</p>
<p>If you are installing FreeNX on a remote server, you will also need to install a Desktop environment on the machine in order to run the remote session. An easy to do that for Gnome is to run this command :</p>
<p>yum groupinstall &#39;GNOME Desktop Environment&#39; &#39;X Window System&#39;</p>
<p>Note: If you are running CentOS 5, yum groupinstall &quot;GNOME Desktop Environment&quot; may complain about a missing libgaim.so.0. This is a known bug. Please see CentOS-5 FAQ for details.</p>
<p>FreeNX expects to make an ssh connection at 127.0.0.1, i.e., at the local host address. If you haven&#39;t changed your default sshd_config, the sshd daemon will be available at that IP address.</p>
<p>However, if you have modified the ListenAddress lines in /etc/ssh/sshd_config, this can cause a problem. Make sure that sshd is available at 127.0.0.1. This can be checked with</p>
<p>netstat -an |grep 22</p>
<p>The result should be similar to</p>
<p>tcp&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp; 0 0.0.0.0:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LISTEN</p>
<pre><code>tcp&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span>&amp;nbsp;&amp;nbsp; <span class="number">0</span> <span class="symbol">:</span><span class="symbol">:</span><span class="symbol">:</span><span class="number">22</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span><span class="symbol">:*&amp;nbsp</span>;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="constant">LISTEN</span>
</code></pre><p>(The above assumes that you use the default port 22 for ssh connections.) This output indicates that sshd is listening on all addresses.</p>
<p>If remotely connected, use the screen command. You are about to restart sshd which will disconnect a remote ssh session. (There are other ways to restart the sshd daemon without disconnecting yourself, but screen is one of the easiest ones.).</p>
<p>screen</p>
<p>This should give you a command prompt. Restart sshd.</p>
<p>/etc/init.d/sshd restart</p>
<p>Use netstat -an again to check that it is now listening at 127.0.0.1.</p>
<p>netstat -an</p>
<p>You should now see something like</p>
<p>tcp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 192.168.1.20:22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0.0.0:*&nbsp;&nbsp;&nbsp; LISTEN</p>
<pre><code>tcp&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">127.0</span>.<span class="number">0</span>.<span class="number">1</span><span class="symbol">:</span><span class="number">22</span>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span><span class="symbol">:*&amp;nbsp</span>;&amp;nbsp;&amp;nbsp; <span class="constant">LISTEN</span>
</code></pre><p>FreeNX will now be able to connect.</p>
<p><a href="http://wiki.centos.org/HowTos/FreeNX" target="_blank" rel="external">http://wiki.centos.org/HowTos/FreeNX</a></p>
<p>Firewall ports</p>
<p>&nbsp;&nbsp;&nbsp; * NX need at least 2 ports: NX port and X11 port</p>
<pre><code>&amp;nbsp;&amp;nbsp;&amp;nbsp; * NX port = <span class="number">4000</span> + display <span class="built_in">number</span> (<span class="built_in">open</span> port <span class="number">5000</span>-<span class="number">5200</span> <span class="command"><span class="keyword">on</span> <span class="title">firewall</span>)</span>

&amp;nbsp;&amp;nbsp;&amp;nbsp; * X11 port = <span class="number">6000</span> + display <span class="built_in">number</span> (i.e. <span class="built_in">open</span> port <span class="number">7000</span>-<span class="number">7200</span> <span class="command"><span class="keyword">on</span> <span class="title">firewall</span>)</span>
</code></pre><p>nx不能连接错误排除：</p>
<p>freenx server 一连接上立即失效</p>
<pre><code>已经通过密码验证，而且windows版的客户端还会出现一个有nomechine的logo的窗口，但是立刻就消失了，提示

Session <span class="keyword">...</span> failed.

详细信息：

Error: Connection with remote peer broken.

Error: Please check the state of your network and retry.

Session: Terminating session at &amp;<span class="comment">#39;Tue Sep 16 17:24:20 2008&amp;#39;.</span>

Session: Session terminated at &amp;<span class="comment">#39;Tue Sep 16 17:24:20 2008&amp;#39;.</span>
</code></pre><p>解决：</p>
<pre><code>检查服务器~user<span class="regexp">/.nx/</span>目录。

检查gnome或kde是否安装，与nxclient设置是否一致。
</code></pre><p>yum groupinstall &#39;KDE Desktop&#39; -y</p>
</div><footer class="post__foot u-cf"><a href="/2010/05/12/w/e7-94-a8nxserver-e4-bb-a3-e6-9b-bfvnc-server-e5-ae-9e-e7-8e-b0-e5-bf-ab-e9-80-9f-e8-bf-9c-e7-a8-8b-e6-a1-8c-e9-9d-a2-e7-ae-a1-e7-90-86/#comments" class="post__foot-link u-fr">评论</a></footer></article><article class="post"><header class="post__head"><time datetime="2010-04-27T02:49:58.000Z" class="post__time">四月 27, 2010</time><h1 class="post__title"><a href="/2010/04/27/w/wordpress-e5-b8-b8-e7-94-a8-e7-bb-b4-e6-8a-a4-e6-98-8e-e4-bb-a4/">wordpress常用维护明令</a></h1></header><div class="post__main"><p>备份数据库(innodb)</p>
<pre><code>/usr/local/mysql/bin/mysqldump -uuser -ppass --single-transaction --<span class="keyword">default</span>-character-<span class="keyword">set</span>=utf8 --opt --extended-insert=<span class="keyword">false</span> --triggers --routines --hex-blob&amp;nbsp; wpdatabase &amp;gt; wpdatabase.`date +%F`.sql

清理Revisions(历史版本)

use wpdatabase;

<span class="keyword">select</span> count(<span class="number">1</span>) <span class="keyword">from</span> wp_posts <span class="keyword">where</span> post_type=&amp;<span class="string">#39</span>;revision&amp;<span class="string">#39</span>;;

delete <span class="keyword">from</span> wp_posts <span class="keyword">where</span> post_type=&amp;<span class="string">#39</span>;revision&amp;<span class="string">#39</span>;;

&amp;nbsp;
</code></pre></div><footer class="post__foot u-cf"><a href="/2010/04/27/w/wordpress-e5-b8-b8-e7-94-a8-e7-bb-b4-e6-8a-a4-e6-98-8e-e4-bb-a4/#comments" class="post__foot-link u-fr">评论</a></footer></article></main><aside class="site-aside"><div class="widget about"><div class="b"><div class="info u-cf"><img src="/avatar.jpg"><div class="text"> <p>dayu graceful</p><p>vegan</p><p>linux sysadm</p><p> <a href="dayu2829@sina.com" title="wiebo" class="weibo ico"></a><a href="kindquiet@qq.com" title="qq" class="qq ico"></a></p></div></div></div></div><div class="widget tags"><div class="h">categories</div><div class="b"> <ul><li><a href="/categories/计算机/">计算机</a><small>(136)</small></li><li><a href="/categories/佛法传统文化/">佛法传统文化</a><small>(18)</small></li><li><a href="/categories/健康/">健康</a><small>(13)</small></li><li><a href="/categories/学习/">学习</a><small>(3)</small></li><li><a href="/categories/网络/">网络</a><small>(1)</small></li><li><a href="/categories/佛法传统文化/健康/">健康</a><small>(1)</small></li></ul></div></div><div class="widget links"><div class="h">links</div><div class="b"> <ul><li><a href="http://www.enzymesos.com/">酵素Enzyme救地球</a></li><li><a href="http://www.osalt.com/">商业软件的开源替代品</a></li></ul></div></div></aside></section><footer class="site-foot"><div class="inner"><div class="site-copy u-fl">© 2015 dayu<bdi> ❤ Theme by <a href="http://riny.net" target="_blank">Bubblings</a></bdi></div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/page/10/" class="page-menu__link icon-arrow-left">prev</a></li><li class="page-menu__item"><a title="Next" href="/page/12/" class="page-menu__link icon-arrow-right">next</a></li></menu></div></footer><div id="back-top" title="返回顶部"></div><script src="/js/script.js"></script></body></html>